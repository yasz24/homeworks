!function(t){var n={};function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)e.d(r,a,function(n){return t[n]}.bind(null,a));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=5)}([function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"EPSILON",(function(){return d})),e.d(r,"ARRAY_TYPE",(function(){return m})),e.d(r,"RANDOM",(function(){return p})),e.d(r,"setMatrixArrayType",(function(){return v})),e.d(r,"toRadian",(function(){return b})),e.d(r,"equals",(function(){return g}));var a={};e.r(a),e.d(a,"create",(function(){return y})),e.d(a,"clone",(function(){return w})),e.d(a,"copy",(function(){return x})),e.d(a,"identity",(function(){return T})),e.d(a,"fromValues",(function(){return j})),e.d(a,"set",(function(){return P})),e.d(a,"transpose",(function(){return A})),e.d(a,"invert",(function(){return V})),e.d(a,"adjoint",(function(){return S})),e.d(a,"determinant",(function(){return L})),e.d(a,"multiply",(function(){return D})),e.d(a,"rotate",(function(){return E})),e.d(a,"scale",(function(){return O})),e.d(a,"fromRotation",(function(){return N})),e.d(a,"fromScaling",(function(){return R})),e.d(a,"str",(function(){return I})),e.d(a,"frob",(function(){return _})),e.d(a,"LDU",(function(){return $})),e.d(a,"add",(function(){return F})),e.d(a,"subtract",(function(){return k})),e.d(a,"exactEquals",(function(){return q})),e.d(a,"equals",(function(){return C})),e.d(a,"multiplyScalar",(function(){return B})),e.d(a,"multiplyScalarAndAdd",(function(){return U})),e.d(a,"mul",(function(){return z})),e.d(a,"sub",(function(){return J}));var i={};e.r(i),e.d(i,"create",(function(){return G})),e.d(i,"clone",(function(){return Y})),e.d(i,"copy",(function(){return X})),e.d(i,"identity",(function(){return W})),e.d(i,"fromValues",(function(){return H})),e.d(i,"set",(function(){return Q})),e.d(i,"invert",(function(){return Z})),e.d(i,"determinant",(function(){return K})),e.d(i,"multiply",(function(){return tt})),e.d(i,"rotate",(function(){return nt})),e.d(i,"scale",(function(){return et})),e.d(i,"translate",(function(){return rt})),e.d(i,"fromRotation",(function(){return at})),e.d(i,"fromScaling",(function(){return it})),e.d(i,"fromTranslation",(function(){return ot})),e.d(i,"str",(function(){return st})),e.d(i,"frob",(function(){return ut})),e.d(i,"add",(function(){return ct})),e.d(i,"subtract",(function(){return ht})),e.d(i,"multiplyScalar",(function(){return ft})),e.d(i,"multiplyScalarAndAdd",(function(){return lt})),e.d(i,"exactEquals",(function(){return dt})),e.d(i,"equals",(function(){return mt})),e.d(i,"mul",(function(){return pt})),e.d(i,"sub",(function(){return vt}));var o={};e.r(o),e.d(o,"create",(function(){return Mt})),e.d(o,"fromMat4",(function(){return bt})),e.d(o,"clone",(function(){return gt})),e.d(o,"copy",(function(){return yt})),e.d(o,"fromValues",(function(){return wt})),e.d(o,"set",(function(){return xt})),e.d(o,"identity",(function(){return Tt})),e.d(o,"transpose",(function(){return jt})),e.d(o,"invert",(function(){return Pt})),e.d(o,"adjoint",(function(){return At})),e.d(o,"determinant",(function(){return Vt})),e.d(o,"multiply",(function(){return St})),e.d(o,"translate",(function(){return Lt})),e.d(o,"rotate",(function(){return Dt})),e.d(o,"scale",(function(){return Et})),e.d(o,"fromTranslation",(function(){return Ot})),e.d(o,"fromRotation",(function(){return Nt})),e.d(o,"fromScaling",(function(){return Rt})),e.d(o,"fromMat2d",(function(){return It})),e.d(o,"fromQuat",(function(){return _t})),e.d(o,"normalFromMat4",(function(){return $t})),e.d(o,"projection",(function(){return Ft})),e.d(o,"str",(function(){return kt})),e.d(o,"frob",(function(){return qt})),e.d(o,"add",(function(){return Ct})),e.d(o,"subtract",(function(){return Bt})),e.d(o,"multiplyScalar",(function(){return Ut})),e.d(o,"multiplyScalarAndAdd",(function(){return zt})),e.d(o,"exactEquals",(function(){return Jt})),e.d(o,"equals",(function(){return Gt})),e.d(o,"mul",(function(){return Yt})),e.d(o,"sub",(function(){return Xt}));var s={};e.r(s),e.d(s,"create",(function(){return Wt})),e.d(s,"clone",(function(){return Ht})),e.d(s,"copy",(function(){return Qt})),e.d(s,"fromValues",(function(){return Zt})),e.d(s,"set",(function(){return Kt})),e.d(s,"identity",(function(){return tn})),e.d(s,"transpose",(function(){return nn})),e.d(s,"invert",(function(){return en})),e.d(s,"adjoint",(function(){return rn})),e.d(s,"determinant",(function(){return an})),e.d(s,"multiply",(function(){return on})),e.d(s,"translate",(function(){return sn})),e.d(s,"scale",(function(){return un})),e.d(s,"rotate",(function(){return cn})),e.d(s,"rotateX",(function(){return hn})),e.d(s,"rotateY",(function(){return fn})),e.d(s,"rotateZ",(function(){return ln})),e.d(s,"fromTranslation",(function(){return dn})),e.d(s,"fromScaling",(function(){return mn})),e.d(s,"fromRotation",(function(){return pn})),e.d(s,"fromXRotation",(function(){return vn})),e.d(s,"fromYRotation",(function(){return Mn})),e.d(s,"fromZRotation",(function(){return bn})),e.d(s,"fromRotationTranslation",(function(){return gn})),e.d(s,"fromQuat2",(function(){return yn})),e.d(s,"getTranslation",(function(){return wn})),e.d(s,"getScaling",(function(){return xn})),e.d(s,"getRotation",(function(){return Tn})),e.d(s,"fromRotationTranslationScale",(function(){return jn})),e.d(s,"fromRotationTranslationScaleOrigin",(function(){return Pn})),e.d(s,"fromQuat",(function(){return An})),e.d(s,"frustum",(function(){return Vn})),e.d(s,"perspective",(function(){return Sn})),e.d(s,"perspectiveFromFieldOfView",(function(){return Ln})),e.d(s,"ortho",(function(){return Dn})),e.d(s,"lookAt",(function(){return En})),e.d(s,"targetTo",(function(){return On})),e.d(s,"str",(function(){return Nn})),e.d(s,"frob",(function(){return Rn})),e.d(s,"add",(function(){return In})),e.d(s,"subtract",(function(){return _n})),e.d(s,"multiplyScalar",(function(){return $n})),e.d(s,"multiplyScalarAndAdd",(function(){return Fn})),e.d(s,"exactEquals",(function(){return kn})),e.d(s,"equals",(function(){return qn})),e.d(s,"mul",(function(){return Cn})),e.d(s,"sub",(function(){return Bn}));var u={};e.r(u),e.d(u,"create",(function(){return Un})),e.d(u,"clone",(function(){return zn})),e.d(u,"length",(function(){return Jn})),e.d(u,"fromValues",(function(){return Gn})),e.d(u,"copy",(function(){return Yn})),e.d(u,"set",(function(){return Xn})),e.d(u,"add",(function(){return Wn})),e.d(u,"subtract",(function(){return Hn})),e.d(u,"multiply",(function(){return Qn})),e.d(u,"divide",(function(){return Zn})),e.d(u,"ceil",(function(){return Kn})),e.d(u,"floor",(function(){return te})),e.d(u,"min",(function(){return ne})),e.d(u,"max",(function(){return ee})),e.d(u,"round",(function(){return re})),e.d(u,"scale",(function(){return ae})),e.d(u,"scaleAndAdd",(function(){return ie})),e.d(u,"distance",(function(){return oe})),e.d(u,"squaredDistance",(function(){return se})),e.d(u,"squaredLength",(function(){return ue})),e.d(u,"negate",(function(){return ce})),e.d(u,"inverse",(function(){return he})),e.d(u,"normalize",(function(){return fe})),e.d(u,"dot",(function(){return le})),e.d(u,"cross",(function(){return de})),e.d(u,"lerp",(function(){return me})),e.d(u,"hermite",(function(){return pe})),e.d(u,"bezier",(function(){return ve})),e.d(u,"random",(function(){return Me})),e.d(u,"transformMat4",(function(){return be})),e.d(u,"transformMat3",(function(){return ge})),e.d(u,"transformQuat",(function(){return ye})),e.d(u,"rotateX",(function(){return we})),e.d(u,"rotateY",(function(){return xe})),e.d(u,"rotateZ",(function(){return Te})),e.d(u,"angle",(function(){return je})),e.d(u,"zero",(function(){return Pe})),e.d(u,"str",(function(){return Ae})),e.d(u,"exactEquals",(function(){return Ve})),e.d(u,"equals",(function(){return Se})),e.d(u,"sub",(function(){return De})),e.d(u,"mul",(function(){return Ee})),e.d(u,"div",(function(){return Oe})),e.d(u,"dist",(function(){return Ne})),e.d(u,"sqrDist",(function(){return Re})),e.d(u,"len",(function(){return Ie})),e.d(u,"sqrLen",(function(){return _e})),e.d(u,"forEach",(function(){return $e}));var c={};e.r(c),e.d(c,"create",(function(){return Fe})),e.d(c,"clone",(function(){return ke})),e.d(c,"fromValues",(function(){return qe})),e.d(c,"copy",(function(){return Ce})),e.d(c,"set",(function(){return Be})),e.d(c,"add",(function(){return Ue})),e.d(c,"subtract",(function(){return ze})),e.d(c,"multiply",(function(){return Je})),e.d(c,"divide",(function(){return Ge})),e.d(c,"ceil",(function(){return Ye})),e.d(c,"floor",(function(){return Xe})),e.d(c,"min",(function(){return We})),e.d(c,"max",(function(){return He})),e.d(c,"round",(function(){return Qe})),e.d(c,"scale",(function(){return Ze})),e.d(c,"scaleAndAdd",(function(){return Ke})),e.d(c,"distance",(function(){return tr})),e.d(c,"squaredDistance",(function(){return nr})),e.d(c,"length",(function(){return er})),e.d(c,"squaredLength",(function(){return rr})),e.d(c,"negate",(function(){return ar})),e.d(c,"inverse",(function(){return ir})),e.d(c,"normalize",(function(){return or})),e.d(c,"dot",(function(){return sr})),e.d(c,"cross",(function(){return ur})),e.d(c,"lerp",(function(){return cr})),e.d(c,"random",(function(){return hr})),e.d(c,"transformMat4",(function(){return fr})),e.d(c,"transformQuat",(function(){return lr})),e.d(c,"zero",(function(){return dr})),e.d(c,"str",(function(){return mr})),e.d(c,"exactEquals",(function(){return pr})),e.d(c,"equals",(function(){return vr})),e.d(c,"sub",(function(){return Mr})),e.d(c,"mul",(function(){return br})),e.d(c,"div",(function(){return gr})),e.d(c,"dist",(function(){return yr})),e.d(c,"sqrDist",(function(){return wr})),e.d(c,"len",(function(){return xr})),e.d(c,"sqrLen",(function(){return Tr})),e.d(c,"forEach",(function(){return jr}));var h={};e.r(h),e.d(h,"create",(function(){return Pr})),e.d(h,"identity",(function(){return Ar})),e.d(h,"setAxisAngle",(function(){return Vr})),e.d(h,"getAxisAngle",(function(){return Sr})),e.d(h,"getAngle",(function(){return Lr})),e.d(h,"multiply",(function(){return Dr})),e.d(h,"rotateX",(function(){return Er})),e.d(h,"rotateY",(function(){return Or})),e.d(h,"rotateZ",(function(){return Nr})),e.d(h,"calculateW",(function(){return Rr})),e.d(h,"exp",(function(){return Ir})),e.d(h,"ln",(function(){return _r})),e.d(h,"pow",(function(){return $r})),e.d(h,"slerp",(function(){return Fr})),e.d(h,"random",(function(){return kr})),e.d(h,"invert",(function(){return qr})),e.d(h,"conjugate",(function(){return Cr})),e.d(h,"fromMat3",(function(){return Br})),e.d(h,"fromEuler",(function(){return Ur})),e.d(h,"str",(function(){return zr})),e.d(h,"clone",(function(){return Qr})),e.d(h,"fromValues",(function(){return Zr})),e.d(h,"copy",(function(){return Kr})),e.d(h,"set",(function(){return ta})),e.d(h,"add",(function(){return na})),e.d(h,"mul",(function(){return ea})),e.d(h,"scale",(function(){return ra})),e.d(h,"dot",(function(){return aa})),e.d(h,"lerp",(function(){return ia})),e.d(h,"length",(function(){return oa})),e.d(h,"len",(function(){return sa})),e.d(h,"squaredLength",(function(){return ua})),e.d(h,"sqrLen",(function(){return ca})),e.d(h,"normalize",(function(){return ha})),e.d(h,"exactEquals",(function(){return fa})),e.d(h,"equals",(function(){return la})),e.d(h,"rotationTo",(function(){return da})),e.d(h,"sqlerp",(function(){return ma})),e.d(h,"setAxes",(function(){return pa}));var f={};e.r(f),e.d(f,"create",(function(){return va})),e.d(f,"clone",(function(){return Ma})),e.d(f,"fromValues",(function(){return ba})),e.d(f,"fromRotationTranslationValues",(function(){return ga})),e.d(f,"fromRotationTranslation",(function(){return ya})),e.d(f,"fromTranslation",(function(){return wa})),e.d(f,"fromRotation",(function(){return xa})),e.d(f,"fromMat4",(function(){return Ta})),e.d(f,"copy",(function(){return ja})),e.d(f,"identity",(function(){return Pa})),e.d(f,"set",(function(){return Aa})),e.d(f,"getReal",(function(){return Va})),e.d(f,"getDual",(function(){return Sa})),e.d(f,"setReal",(function(){return La})),e.d(f,"setDual",(function(){return Da})),e.d(f,"getTranslation",(function(){return Ea})),e.d(f,"translate",(function(){return Oa})),e.d(f,"rotateX",(function(){return Na})),e.d(f,"rotateY",(function(){return Ra})),e.d(f,"rotateZ",(function(){return Ia})),e.d(f,"rotateByQuatAppend",(function(){return _a})),e.d(f,"rotateByQuatPrepend",(function(){return $a})),e.d(f,"rotateAroundAxis",(function(){return Fa})),e.d(f,"add",(function(){return ka})),e.d(f,"multiply",(function(){return qa})),e.d(f,"mul",(function(){return Ca})),e.d(f,"scale",(function(){return Ba})),e.d(f,"dot",(function(){return Ua})),e.d(f,"lerp",(function(){return za})),e.d(f,"invert",(function(){return Ja})),e.d(f,"conjugate",(function(){return Ga})),e.d(f,"length",(function(){return Ya})),e.d(f,"len",(function(){return Xa})),e.d(f,"squaredLength",(function(){return Wa})),e.d(f,"sqrLen",(function(){return Ha})),e.d(f,"normalize",(function(){return Qa})),e.d(f,"str",(function(){return Za})),e.d(f,"exactEquals",(function(){return Ka})),e.d(f,"equals",(function(){return ti}));var l={};e.r(l),e.d(l,"create",(function(){return ni})),e.d(l,"clone",(function(){return ei})),e.d(l,"fromValues",(function(){return ri})),e.d(l,"copy",(function(){return ai})),e.d(l,"set",(function(){return ii})),e.d(l,"add",(function(){return oi})),e.d(l,"subtract",(function(){return si})),e.d(l,"multiply",(function(){return ui})),e.d(l,"divide",(function(){return ci})),e.d(l,"ceil",(function(){return hi})),e.d(l,"floor",(function(){return fi})),e.d(l,"min",(function(){return li})),e.d(l,"max",(function(){return di})),e.d(l,"round",(function(){return mi})),e.d(l,"scale",(function(){return pi})),e.d(l,"scaleAndAdd",(function(){return vi})),e.d(l,"distance",(function(){return Mi})),e.d(l,"squaredDistance",(function(){return bi})),e.d(l,"length",(function(){return gi})),e.d(l,"squaredLength",(function(){return yi})),e.d(l,"negate",(function(){return wi})),e.d(l,"inverse",(function(){return xi})),e.d(l,"normalize",(function(){return Ti})),e.d(l,"dot",(function(){return ji})),e.d(l,"cross",(function(){return Pi})),e.d(l,"lerp",(function(){return Ai})),e.d(l,"random",(function(){return Vi})),e.d(l,"transformMat2",(function(){return Si})),e.d(l,"transformMat2d",(function(){return Li})),e.d(l,"transformMat3",(function(){return Di})),e.d(l,"transformMat4",(function(){return Ei})),e.d(l,"rotate",(function(){return Oi})),e.d(l,"angle",(function(){return Ni})),e.d(l,"zero",(function(){return Ri})),e.d(l,"str",(function(){return Ii})),e.d(l,"exactEquals",(function(){return _i})),e.d(l,"equals",(function(){return $i})),e.d(l,"len",(function(){return Fi})),e.d(l,"sub",(function(){return ki})),e.d(l,"mul",(function(){return qi})),e.d(l,"div",(function(){return Ci})),e.d(l,"dist",(function(){return Bi})),e.d(l,"sqrDist",(function(){return Ui})),e.d(l,"sqrLen",(function(){return zi})),e.d(l,"forEach",(function(){return Ji}));var d=1e-6,m="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function v(t){m=t}var M=Math.PI/180;function b(t){return t*M}function g(t,n){return Math.abs(t-n)<=d*Math.max(1,Math.abs(t),Math.abs(n))}function y(){var t=new m(4);return m!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function w(t){var n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function x(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function T(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function j(t,n,e,r){var a=new m(4);return a[0]=t,a[1]=n,a[2]=e,a[3]=r,a}function P(t,n,e,r,a){return t[0]=n,t[1]=e,t[2]=r,t[3]=a,t}function A(t,n){if(t===n){var e=n[1];t[1]=n[2],t[2]=e}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function V(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=e*i-a*r;return o?(o=1/o,t[0]=i*o,t[1]=-r*o,t[2]=-a*o,t[3]=e*o,t):null}function S(t,n){var e=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=e,t}function L(t){return t[0]*t[3]-t[2]*t[1]}function D(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=e[0],u=e[1],c=e[2],h=e[3];return t[0]=r*s+i*u,t[1]=a*s+o*u,t[2]=r*c+i*h,t[3]=a*c+o*h,t}function E(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u+i*s,t[1]=a*u+o*s,t[2]=r*-s+i*u,t[3]=a*-s+o*u,t}function O(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=e[0],u=e[1];return t[0]=r*s,t[1]=a*s,t[2]=i*u,t[3]=o*u,t}function N(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t}function R(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function I(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function _(t){return Math.hypot(t[0],t[1],t[2],t[3])}function $(t,n,e,r){return t[2]=r[2]/r[0],e[0]=r[0],e[1]=r[1],e[3]=r[3]-t[2]*e[1],[t,n,e]}function F(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function k(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function q(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function C(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=n[0],s=n[1],u=n[2],c=n[3];return Math.abs(e-o)<=d*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=d*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=d*Math.max(1,Math.abs(i),Math.abs(c))}function B(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function U(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)});var z=D,J=k;function G(){var t=new m(6);return m!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Y(t){var n=new m(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function X(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function W(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function H(t,n,e,r,a,i){var o=new m(6);return o[0]=t,o[1]=n,o[2]=e,o[3]=r,o[4]=a,o[5]=i,o}function Q(t,n,e,r,a,i,o){return t[0]=n,t[1]=e,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t}function Z(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=n[4],s=n[5],u=e*i-r*a;return u?(u=1/u,t[0]=i*u,t[1]=-r*u,t[2]=-a*u,t[3]=e*u,t[4]=(a*s-i*o)*u,t[5]=(r*o-e*s)*u,t):null}function K(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=e[0],h=e[1],f=e[2],l=e[3],d=e[4],m=e[5];return t[0]=r*c+i*h,t[1]=a*c+o*h,t[2]=r*f+i*l,t[3]=a*f+o*l,t[4]=r*d+i*m+s,t[5]=a*d+o*m+u,t}function nt(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=Math.sin(e),h=Math.cos(e);return t[0]=r*h+i*c,t[1]=a*h+o*c,t[2]=r*-c+i*h,t[3]=a*-c+o*h,t[4]=s,t[5]=u,t}function et(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=e[0],h=e[1];return t[0]=r*c,t[1]=a*c,t[2]=i*h,t[3]=o*h,t[4]=s,t[5]=u,t}function rt(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=e[0],h=e[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=r*c+i*h+s,t[5]=a*c+o*h+u,t}function at(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t[4]=0,t[5]=0,t}function it(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function ot(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t}function ht(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t}function ft(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t}function lt(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t}function dt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function mt(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=n[0],c=n[1],h=n[2],f=n[3],l=n[4],m=n[5];return Math.abs(e-u)<=d*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-h)<=d*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-f)<=d*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-l)<=d*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))}var pt=tt,vt=ht;function Mt(){var t=new m(9);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function bt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function gt(t){var n=new m(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function yt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function wt(t,n,e,r,a,i,o,s,u){var c=new m(9);return c[0]=t,c[1]=n,c[2]=e,c[3]=r,c[4]=a,c[5]=i,c[6]=o,c[7]=s,c[8]=u,c}function xt(t,n,e,r,a,i,o,s,u,c){return t[0]=n,t[1]=e,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t}function Tt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function jt(t,n){if(t===n){var e=n[1],r=n[2],a=n[5];t[1]=n[3],t[2]=n[6],t[3]=e,t[5]=n[7],t[6]=r,t[7]=a}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function Pt(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=n[4],s=n[5],u=n[6],c=n[7],h=n[8],f=h*o-s*c,l=-h*i+s*u,d=c*i-o*u,m=e*f+r*l+a*d;return m?(m=1/m,t[0]=f*m,t[1]=(-h*r+a*c)*m,t[2]=(s*r-a*o)*m,t[3]=l*m,t[4]=(h*e-a*u)*m,t[5]=(-s*e+a*i)*m,t[6]=d*m,t[7]=(-c*e+r*u)*m,t[8]=(o*e-r*i)*m,t):null}function At(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=n[4],s=n[5],u=n[6],c=n[7],h=n[8];return t[0]=o*h-s*c,t[1]=a*c-r*h,t[2]=r*s-a*o,t[3]=s*u-i*h,t[4]=e*h-a*u,t[5]=a*i-e*s,t[6]=i*c-o*u,t[7]=r*u-e*c,t[8]=e*o-r*i,t}function Vt(t){var n=t[0],e=t[1],r=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return n*(c*i-o*u)+e*(-c*a+o*s)+r*(u*a-i*s)}function St(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=n[8],l=e[0],d=e[1],m=e[2],p=e[3],v=e[4],M=e[5],b=e[6],g=e[7],y=e[8];return t[0]=l*r+d*o+m*c,t[1]=l*a+d*s+m*h,t[2]=l*i+d*u+m*f,t[3]=p*r+v*o+M*c,t[4]=p*a+v*s+M*h,t[5]=p*i+v*u+M*f,t[6]=b*r+g*o+y*c,t[7]=b*a+g*s+y*h,t[8]=b*i+g*u+y*f,t}function Lt(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=n[8],l=e[0],d=e[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=l*r+d*o+c,t[7]=l*a+d*s+h,t[8]=l*i+d*u+f,t}function Dt(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=n[8],l=Math.sin(e),d=Math.cos(e);return t[0]=d*r+l*o,t[1]=d*a+l*s,t[2]=d*i+l*u,t[3]=d*o-l*r,t[4]=d*s-l*a,t[5]=d*u-l*i,t[6]=c,t[7]=h,t[8]=f,t}function Et(t,n,e){var r=e[0],a=e[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=a*n[3],t[4]=a*n[4],t[5]=a*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function Ot(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function Nt(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=-e,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Rt(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function _t(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=e+e,s=r+r,u=a+a,c=e*o,h=r*o,f=r*s,l=a*o,d=a*s,m=a*u,p=i*o,v=i*s,M=i*u;return t[0]=1-f-m,t[3]=h-M,t[6]=l+v,t[1]=h+M,t[4]=1-c-m,t[7]=d-p,t[2]=l-v,t[5]=d+p,t[8]=1-c-f,t}function $t(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=n[4],s=n[5],u=n[6],c=n[7],h=n[8],f=n[9],l=n[10],d=n[11],m=n[12],p=n[13],v=n[14],M=n[15],b=e*s-r*o,g=e*u-a*o,y=e*c-i*o,w=r*u-a*s,x=r*c-i*s,T=a*c-i*u,j=h*p-f*m,P=h*v-l*m,A=h*M-d*m,V=f*v-l*p,S=f*M-d*p,L=l*M-d*v,D=b*L-g*S+y*V+w*A-x*P+T*j;return D?(D=1/D,t[0]=(s*L-u*S+c*V)*D,t[1]=(u*A-o*L-c*P)*D,t[2]=(o*S-s*A+c*j)*D,t[3]=(a*S-r*L-i*V)*D,t[4]=(e*L-a*A+i*P)*D,t[5]=(r*A-e*S-i*j)*D,t[6]=(p*T-v*x+M*w)*D,t[7]=(v*y-m*T-M*g)*D,t[8]=(m*x-p*y+M*b)*D,t):null}function Ft(t,n,e){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/e,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function kt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function qt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ct(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t}function Bt(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t}function Ut(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t}function zt(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t}function Jt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function Gt(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=n[0],l=n[1],m=n[2],p=n[3],v=n[4],M=n[5],b=n[6],g=n[7],y=n[8];return Math.abs(e-f)<=d*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-m)<=d*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(i-p)<=d*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-v)<=d*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-M)<=d*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-b)<=d*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-y)<=d*Math.max(1,Math.abs(h),Math.abs(y))}var Yt=St,Xt=Bt;function Wt(){var t=new m(16);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ht(t){var n=new m(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Qt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Zt(t,n,e,r,a,i,o,s,u,c,h,f,l,d,p,v){var M=new m(16);return M[0]=t,M[1]=n,M[2]=e,M[3]=r,M[4]=a,M[5]=i,M[6]=o,M[7]=s,M[8]=u,M[9]=c,M[10]=h,M[11]=f,M[12]=l,M[13]=d,M[14]=p,M[15]=v,M}function Kt(t,n,e,r,a,i,o,s,u,c,h,f,l,d,m,p,v){return t[0]=n,t[1]=e,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=f,t[11]=l,t[12]=d,t[13]=m,t[14]=p,t[15]=v,t}function tn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nn(t,n){if(t===n){var e=n[1],r=n[2],a=n[3],i=n[6],o=n[7],s=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=e,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=i,t[11]=n[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function en(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=n[4],s=n[5],u=n[6],c=n[7],h=n[8],f=n[9],l=n[10],d=n[11],m=n[12],p=n[13],v=n[14],M=n[15],b=e*s-r*o,g=e*u-a*o,y=e*c-i*o,w=r*u-a*s,x=r*c-i*s,T=a*c-i*u,j=h*p-f*m,P=h*v-l*m,A=h*M-d*m,V=f*v-l*p,S=f*M-d*p,L=l*M-d*v,D=b*L-g*S+y*V+w*A-x*P+T*j;return D?(D=1/D,t[0]=(s*L-u*S+c*V)*D,t[1]=(a*S-r*L-i*V)*D,t[2]=(p*T-v*x+M*w)*D,t[3]=(l*x-f*T-d*w)*D,t[4]=(u*A-o*L-c*P)*D,t[5]=(e*L-a*A+i*P)*D,t[6]=(v*y-m*T-M*g)*D,t[7]=(h*T-l*y+d*g)*D,t[8]=(o*S-s*A+c*j)*D,t[9]=(r*A-e*S-i*j)*D,t[10]=(m*x-p*y+M*b)*D,t[11]=(f*y-h*x-d*b)*D,t[12]=(s*P-o*V-u*j)*D,t[13]=(e*V-r*P+a*j)*D,t[14]=(p*g-m*w-v*b)*D,t[15]=(h*w-f*g+l*b)*D,t):null}function rn(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=n[4],s=n[5],u=n[6],c=n[7],h=n[8],f=n[9],l=n[10],d=n[11],m=n[12],p=n[13],v=n[14],M=n[15];return t[0]=s*(l*M-d*v)-f*(u*M-c*v)+p*(u*d-c*l),t[1]=-(r*(l*M-d*v)-f*(a*M-i*v)+p*(a*d-i*l)),t[2]=r*(u*M-c*v)-s*(a*M-i*v)+p*(a*c-i*u),t[3]=-(r*(u*d-c*l)-s*(a*d-i*l)+f*(a*c-i*u)),t[4]=-(o*(l*M-d*v)-h*(u*M-c*v)+m*(u*d-c*l)),t[5]=e*(l*M-d*v)-h*(a*M-i*v)+m*(a*d-i*l),t[6]=-(e*(u*M-c*v)-o*(a*M-i*v)+m*(a*c-i*u)),t[7]=e*(u*d-c*l)-o*(a*d-i*l)+h*(a*c-i*u),t[8]=o*(f*M-d*p)-h*(s*M-c*p)+m*(s*d-c*f),t[9]=-(e*(f*M-d*p)-h*(r*M-i*p)+m*(r*d-i*f)),t[10]=e*(s*M-c*p)-o*(r*M-i*p)+m*(r*c-i*s),t[11]=-(e*(s*d-c*f)-o*(r*d-i*f)+h*(r*c-i*s)),t[12]=-(o*(f*v-l*p)-h*(s*v-u*p)+m*(s*l-u*f)),t[13]=e*(f*v-l*p)-h*(r*v-a*p)+m*(r*l-a*f),t[14]=-(e*(s*v-u*p)-o*(r*v-a*p)+m*(r*u-a*s)),t[15]=e*(s*l-u*f)-o*(r*l-a*f)+h*(r*u-a*s),t}function an(t){var n=t[0],e=t[1],r=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],d=t[12],m=t[13],p=t[14],v=t[15];return(n*o-e*i)*(f*v-l*p)-(n*s-r*i)*(h*v-l*m)+(n*u-a*i)*(h*p-f*m)+(e*s-r*o)*(c*v-l*d)-(e*u-a*o)*(c*p-f*d)+(r*u-a*s)*(c*m-h*d)}function on(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=n[8],l=n[9],d=n[10],m=n[11],p=n[12],v=n[13],M=n[14],b=n[15],g=e[0],y=e[1],w=e[2],x=e[3];return t[0]=g*r+y*s+w*f+x*p,t[1]=g*a+y*u+w*l+x*v,t[2]=g*i+y*c+w*d+x*M,t[3]=g*o+y*h+w*m+x*b,g=e[4],y=e[5],w=e[6],x=e[7],t[4]=g*r+y*s+w*f+x*p,t[5]=g*a+y*u+w*l+x*v,t[6]=g*i+y*c+w*d+x*M,t[7]=g*o+y*h+w*m+x*b,g=e[8],y=e[9],w=e[10],x=e[11],t[8]=g*r+y*s+w*f+x*p,t[9]=g*a+y*u+w*l+x*v,t[10]=g*i+y*c+w*d+x*M,t[11]=g*o+y*h+w*m+x*b,g=e[12],y=e[13],w=e[14],x=e[15],t[12]=g*r+y*s+w*f+x*p,t[13]=g*a+y*u+w*l+x*v,t[14]=g*i+y*c+w*d+x*M,t[15]=g*o+y*h+w*m+x*b,t}function sn(t,n,e){var r,a,i,o,s,u,c,h,f,l,d,m,p=e[0],v=e[1],M=e[2];return n===t?(t[12]=n[0]*p+n[4]*v+n[8]*M+n[12],t[13]=n[1]*p+n[5]*v+n[9]*M+n[13],t[14]=n[2]*p+n[6]*v+n[10]*M+n[14],t[15]=n[3]*p+n[7]*v+n[11]*M+n[15]):(r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=n[8],l=n[9],d=n[10],m=n[11],t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=d,t[11]=m,t[12]=r*p+s*v+f*M+n[12],t[13]=a*p+u*v+l*M+n[13],t[14]=i*p+c*v+d*M+n[14],t[15]=o*p+h*v+m*M+n[15]),t}function un(t,n,e){var r=e[0],a=e[1],i=e[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=n[11]*i,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function cn(t,n,e,r){var a,i,o,s,u,c,h,f,l,m,p,v,M,b,g,y,w,x,T,j,P,A,V,S,L=r[0],D=r[1],E=r[2],O=Math.hypot(L,D,E);return O<d?null:(L*=O=1/O,D*=O,E*=O,a=Math.sin(e),o=1-(i=Math.cos(e)),s=n[0],u=n[1],c=n[2],h=n[3],f=n[4],l=n[5],m=n[6],p=n[7],v=n[8],M=n[9],b=n[10],g=n[11],y=L*L*o+i,w=D*L*o+E*a,x=E*L*o-D*a,T=L*D*o-E*a,j=D*D*o+i,P=E*D*o+L*a,A=L*E*o+D*a,V=D*E*o-L*a,S=E*E*o+i,t[0]=s*y+f*w+v*x,t[1]=u*y+l*w+M*x,t[2]=c*y+m*w+b*x,t[3]=h*y+p*w+g*x,t[4]=s*T+f*j+v*P,t[5]=u*T+l*j+M*P,t[6]=c*T+m*j+b*P,t[7]=h*T+p*j+g*P,t[8]=s*A+f*V+v*S,t[9]=u*A+l*V+M*S,t[10]=c*A+m*V+b*S,t[11]=h*A+p*V+g*S,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function hn(t,n,e){var r=Math.sin(e),a=Math.cos(e),i=n[4],o=n[5],s=n[6],u=n[7],c=n[8],h=n[9],f=n[10],l=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=i*a+c*r,t[5]=o*a+h*r,t[6]=s*a+f*r,t[7]=u*a+l*r,t[8]=c*a-i*r,t[9]=h*a-o*r,t[10]=f*a-s*r,t[11]=l*a-u*r,t}function fn(t,n,e){var r=Math.sin(e),a=Math.cos(e),i=n[0],o=n[1],s=n[2],u=n[3],c=n[8],h=n[9],f=n[10],l=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=i*a-c*r,t[1]=o*a-h*r,t[2]=s*a-f*r,t[3]=u*a-l*r,t[8]=i*r+c*a,t[9]=o*r+h*a,t[10]=s*r+f*a,t[11]=u*r+l*a,t}function ln(t,n,e){var r=Math.sin(e),a=Math.cos(e),i=n[0],o=n[1],s=n[2],u=n[3],c=n[4],h=n[5],f=n[6],l=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=i*a+c*r,t[1]=o*a+h*r,t[2]=s*a+f*r,t[3]=u*a+l*r,t[4]=c*a-i*r,t[5]=h*a-o*r,t[6]=f*a-s*r,t[7]=l*a-u*r,t}function dn(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mn(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pn(t,n,e){var r,a,i,o=e[0],s=e[1],u=e[2],c=Math.hypot(o,s,u);return c<d?null:(o*=c=1/c,s*=c,u*=c,r=Math.sin(n),i=1-(a=Math.cos(n)),t[0]=o*o*i+a,t[1]=s*o*i+u*r,t[2]=u*o*i-s*r,t[3]=0,t[4]=o*s*i-u*r,t[5]=s*s*i+a,t[6]=u*s*i+o*r,t[7]=0,t[8]=o*u*i+s*r,t[9]=s*u*i-o*r,t[10]=u*u*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function vn(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Mn(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bn(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gn(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=r+r,u=a+a,c=i+i,h=r*s,f=r*u,l=r*c,d=a*u,m=a*c,p=i*c,v=o*s,M=o*u,b=o*c;return t[0]=1-(d+p),t[1]=f+b,t[2]=l-M,t[3]=0,t[4]=f-b,t[5]=1-(h+p),t[6]=m+v,t[7]=0,t[8]=l+M,t[9]=m-v,t[10]=1-(h+d),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function yn(t,n){var e=new m(3),r=-n[0],a=-n[1],i=-n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=r*r+a*a+i*i+o*o;return f>0?(e[0]=2*(s*o+h*r+u*i-c*a)/f,e[1]=2*(u*o+h*a+c*r-s*i)/f,e[2]=2*(c*o+h*i+s*a-u*r)/f):(e[0]=2*(s*o+h*r+u*i-c*a),e[1]=2*(u*o+h*a+c*r-s*i),e[2]=2*(c*o+h*i+s*a-u*r)),gn(t,n,e),t}function wn(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function xn(t,n){var e=n[0],r=n[1],a=n[2],i=n[4],o=n[5],s=n[6],u=n[8],c=n[9],h=n[10];return t[0]=Math.hypot(e,r,a),t[1]=Math.hypot(i,o,s),t[2]=Math.hypot(u,c,h),t}function Tn(t,n){var e=new m(3);xn(e,n);var r=1/e[0],a=1/e[1],i=1/e[2],o=n[0]*r,s=n[1]*a,u=n[2]*i,c=n[4]*r,h=n[5]*a,f=n[6]*i,l=n[8]*r,d=n[9]*a,p=n[10]*i,v=o+h+p,M=0;return v>0?(M=2*Math.sqrt(v+1),t[3]=.25*M,t[0]=(f-d)/M,t[1]=(l-u)/M,t[2]=(s-c)/M):o>h&&o>p?(M=2*Math.sqrt(1+o-h-p),t[3]=(f-d)/M,t[0]=.25*M,t[1]=(s+c)/M,t[2]=(l+u)/M):h>p?(M=2*Math.sqrt(1+h-o-p),t[3]=(l-u)/M,t[0]=(s+c)/M,t[1]=.25*M,t[2]=(f+d)/M):(M=2*Math.sqrt(1+p-o-h),t[3]=(s-c)/M,t[0]=(l+u)/M,t[1]=(f+d)/M,t[2]=.25*M),t}function jn(t,n,e,r){var a=n[0],i=n[1],o=n[2],s=n[3],u=a+a,c=i+i,h=o+o,f=a*u,l=a*c,d=a*h,m=i*c,p=i*h,v=o*h,M=s*u,b=s*c,g=s*h,y=r[0],w=r[1],x=r[2];return t[0]=(1-(m+v))*y,t[1]=(l+g)*y,t[2]=(d-b)*y,t[3]=0,t[4]=(l-g)*w,t[5]=(1-(f+v))*w,t[6]=(p+M)*w,t[7]=0,t[8]=(d+b)*x,t[9]=(p-M)*x,t[10]=(1-(f+m))*x,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Pn(t,n,e,r,a){var i=n[0],o=n[1],s=n[2],u=n[3],c=i+i,h=o+o,f=s+s,l=i*c,d=i*h,m=i*f,p=o*h,v=o*f,M=s*f,b=u*c,g=u*h,y=u*f,w=r[0],x=r[1],T=r[2],j=a[0],P=a[1],A=a[2],V=(1-(p+M))*w,S=(d+y)*w,L=(m-g)*w,D=(d-y)*x,E=(1-(l+M))*x,O=(v+b)*x,N=(m+g)*T,R=(v-b)*T,I=(1-(l+p))*T;return t[0]=V,t[1]=S,t[2]=L,t[3]=0,t[4]=D,t[5]=E,t[6]=O,t[7]=0,t[8]=N,t[9]=R,t[10]=I,t[11]=0,t[12]=e[0]+j-(V*j+D*P+N*A),t[13]=e[1]+P-(S*j+E*P+R*A),t[14]=e[2]+A-(L*j+O*P+I*A),t[15]=1,t}function An(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=e+e,s=r+r,u=a+a,c=e*o,h=r*o,f=r*s,l=a*o,d=a*s,m=a*u,p=i*o,v=i*s,M=i*u;return t[0]=1-f-m,t[1]=h+M,t[2]=l-v,t[3]=0,t[4]=h-M,t[5]=1-c-m,t[6]=d+p,t[7]=0,t[8]=l+v,t[9]=d-p,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Vn(t,n,e,r,a,i,o){var s=1/(e-n),u=1/(a-r),c=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(e+n)*s,t[9]=(a+r)*u,t[10]=(o+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*c,t[15]=0,t}function Sn(t,n,e,r,a){var i,o=1/Math.tan(n/2);return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(i=1/(r-a),t[10]=(a+r)*i,t[14]=2*a*r*i):(t[10]=-1,t[14]=-2*r),t}function Ln(t,n,e,r){var a=Math.tan(n.upDegrees*Math.PI/180),i=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),s=Math.tan(n.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(a-i)*c*.5,t[10]=r/(e-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*e/(e-r),t[15]=0,t}function Dn(t,n,e,r,a,i,o){var s=1/(n-e),u=1/(r-a),c=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+e)*s,t[13]=(a+r)*u,t[14]=(o+i)*c,t[15]=1,t}function En(t,n,e,r){var a,i,o,s,u,c,h,f,l,m,p=n[0],v=n[1],M=n[2],b=r[0],g=r[1],y=r[2],w=e[0],x=e[1],T=e[2];return Math.abs(p-w)<d&&Math.abs(v-x)<d&&Math.abs(M-T)<d?tn(t):(h=p-w,f=v-x,l=M-T,a=g*(l*=m=1/Math.hypot(h,f,l))-y*(f*=m),i=y*(h*=m)-b*l,o=b*f-g*h,(m=Math.hypot(a,i,o))?(a*=m=1/m,i*=m,o*=m):(a=0,i=0,o=0),s=f*o-l*i,u=l*a-h*o,c=h*i-f*a,(m=Math.hypot(s,u,c))?(s*=m=1/m,u*=m,c*=m):(s=0,u=0,c=0),t[0]=a,t[1]=s,t[2]=h,t[3]=0,t[4]=i,t[5]=u,t[6]=f,t[7]=0,t[8]=o,t[9]=c,t[10]=l,t[11]=0,t[12]=-(a*p+i*v+o*M),t[13]=-(s*p+u*v+c*M),t[14]=-(h*p+f*v+l*M),t[15]=1,t)}function On(t,n,e,r){var a=n[0],i=n[1],o=n[2],s=r[0],u=r[1],c=r[2],h=a-e[0],f=i-e[1],l=o-e[2],d=h*h+f*f+l*l;d>0&&(h*=d=1/Math.sqrt(d),f*=d,l*=d);var m=u*l-c*f,p=c*h-s*l,v=s*f-u*h;return(d=m*m+p*p+v*v)>0&&(m*=d=1/Math.sqrt(d),p*=d,v*=d),t[0]=m,t[1]=p,t[2]=v,t[3]=0,t[4]=f*v-l*p,t[5]=l*m-h*v,t[6]=h*p-f*m,t[7]=0,t[8]=h,t[9]=f,t[10]=l,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t}function Nn(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Rn(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function In(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t[9]=n[9]+e[9],t[10]=n[10]+e[10],t[11]=n[11]+e[11],t[12]=n[12]+e[12],t[13]=n[13]+e[13],t[14]=n[14]+e[14],t[15]=n[15]+e[15],t}function _n(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t[9]=n[9]-e[9],t[10]=n[10]-e[10],t[11]=n[11]-e[11],t[12]=n[12]-e[12],t[13]=n[13]-e[13],t[14]=n[14]-e[14],t[15]=n[15]-e[15],t}function $n(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=n[11]*e,t[12]=n[12]*e,t[13]=n[13]*e,t[14]=n[14]*e,t[15]=n[15]*e,t}function Fn(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t[9]=n[9]+e[9]*r,t[10]=n[10]+e[10]*r,t[11]=n[11]+e[11]*r,t[12]=n[12]+e[12]*r,t[13]=n[13]+e[13]*r,t[14]=n[14]+e[14]*r,t[15]=n[15]+e[15]*r,t}function kn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function qn(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=t[9],l=t[10],m=t[11],p=t[12],v=t[13],M=t[14],b=t[15],g=n[0],y=n[1],w=n[2],x=n[3],T=n[4],j=n[5],P=n[6],A=n[7],V=n[8],S=n[9],L=n[10],D=n[11],E=n[12],O=n[13],N=n[14],R=n[15];return Math.abs(e-g)<=d*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(r-y)<=d*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(a-w)<=d*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(i-x)<=d*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-T)<=d*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-j)<=d*Math.max(1,Math.abs(s),Math.abs(j))&&Math.abs(u-P)<=d*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(c-A)<=d*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(h-V)<=d*Math.max(1,Math.abs(h),Math.abs(V))&&Math.abs(f-S)<=d*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(l-L)<=d*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(m-D)<=d*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(p-E)<=d*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(v-O)<=d*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(M-N)<=d*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(b-R)<=d*Math.max(1,Math.abs(b),Math.abs(R))}var Cn=on,Bn=_n;function Un(){var t=new m(3);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function zn(t){var n=new m(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Jn(t){var n=t[0],e=t[1],r=t[2];return Math.hypot(n,e,r)}function Gn(t,n,e){var r=new m(3);return r[0]=t,r[1]=n,r[2]=e,r}function Yn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Xn(t,n,e,r){return t[0]=n,t[1]=e,t[2]=r,t}function Wn(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t}function Hn(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t}function Qn(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t}function Zn(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t}function Kn(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function te(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function ne(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t}function ee(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t}function re(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function ae(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function ie(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t}function oe(t,n){var e=n[0]-t[0],r=n[1]-t[1],a=n[2]-t[2];return Math.hypot(e,r,a)}function se(t,n){var e=n[0]-t[0],r=n[1]-t[1],a=n[2]-t[2];return e*e+r*r+a*a}function ue(t){var n=t[0],e=t[1],r=t[2];return n*n+e*e+r*r}function ce(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function he(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function fe(t,n){var e=n[0],r=n[1],a=n[2],i=e*e+r*r+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function le(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function de(t,n,e){var r=n[0],a=n[1],i=n[2],o=e[0],s=e[1],u=e[2];return t[0]=a*u-i*s,t[1]=i*o-r*u,t[2]=r*s-a*o,t}function me(t,n,e,r){var a=n[0],i=n[1],o=n[2];return t[0]=a+r*(e[0]-a),t[1]=i+r*(e[1]-i),t[2]=o+r*(e[2]-o),t}function pe(t,n,e,r,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,c=o*(i-1),h=o*(3-2*i);return t[0]=n[0]*s+e[0]*u+r[0]*c+a[0]*h,t[1]=n[1]*s+e[1]*u+r[1]*c+a[1]*h,t[2]=n[2]*s+e[2]*u+r[2]*c+a[2]*h,t}function ve(t,n,e,r,a,i){var o=1-i,s=o*o,u=i*i,c=s*o,h=3*i*s,f=3*u*o,l=u*i;return t[0]=n[0]*c+e[0]*h+r[0]*f+a[0]*l,t[1]=n[1]*c+e[1]*h+r[1]*f+a[1]*l,t[2]=n[2]*c+e[2]*h+r[2]*f+a[2]*l,t}function Me(t,n){n=n||1;var e=2*p()*Math.PI,r=2*p()-1,a=Math.sqrt(1-r*r)*n;return t[0]=Math.cos(e)*a,t[1]=Math.sin(e)*a,t[2]=r*n,t}function be(t,n,e){var r=n[0],a=n[1],i=n[2],o=e[3]*r+e[7]*a+e[11]*i+e[15];return o=o||1,t[0]=(e[0]*r+e[4]*a+e[8]*i+e[12])/o,t[1]=(e[1]*r+e[5]*a+e[9]*i+e[13])/o,t[2]=(e[2]*r+e[6]*a+e[10]*i+e[14])/o,t}function ge(t,n,e){var r=n[0],a=n[1],i=n[2];return t[0]=r*e[0]+a*e[3]+i*e[6],t[1]=r*e[1]+a*e[4]+i*e[7],t[2]=r*e[2]+a*e[5]+i*e[8],t}function ye(t,n,e){var r=e[0],a=e[1],i=e[2],o=e[3],s=n[0],u=n[1],c=n[2],h=a*c-i*u,f=i*s-r*c,l=r*u-a*s,d=a*l-i*f,m=i*h-r*l,p=r*f-a*h,v=2*o;return h*=v,f*=v,l*=v,d*=2,m*=2,p*=2,t[0]=s+h+d,t[1]=u+f+m,t[2]=c+l+p,t}function we(t,n,e,r){var a=[],i=[];return a[0]=n[0]-e[0],a[1]=n[1]-e[1],a[2]=n[2]-e[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t}function xe(t,n,e,r){var a=[],i=[];return a[0]=n[0]-e[0],a[1]=n[1]-e[1],a[2]=n[2]-e[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t}function Te(t,n,e,r){var a=[],i=[];return a[0]=n[0]-e[0],a[1]=n[1]-e[1],a[2]=n[2]-e[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t}function je(t,n){var e=Gn(t[0],t[1],t[2]),r=Gn(n[0],n[1],n[2]);fe(e,e),fe(r,r);var a=le(e,r);return a>1?0:a<-1?Math.PI:Math.acos(a)}function Pe(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ae(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ve(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Se(t,n){var e=t[0],r=t[1],a=t[2],i=n[0],o=n[1],s=n[2];return Math.abs(e-i)<=d*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-s)<=d*Math.max(1,Math.abs(a),Math.abs(s))}var Le,De=Hn,Ee=Qn,Oe=Zn,Ne=oe,Re=se,Ie=Jn,_e=ue,$e=(Le=Un(),function(t,n,e,r,a,i){var o,s;for(n||(n=3),e||(e=0),s=r?Math.min(r*n+e,t.length):t.length,o=e;o<s;o+=n)Le[0]=t[o],Le[1]=t[o+1],Le[2]=t[o+2],a(Le,Le,i),t[o]=Le[0],t[o+1]=Le[1],t[o+2]=Le[2];return t});function Fe(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function ke(t){var n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function qe(t,n,e,r){var a=new m(4);return a[0]=t,a[1]=n,a[2]=e,a[3]=r,a}function Ce(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function Be(t,n,e,r,a){return t[0]=n,t[1]=e,t[2]=r,t[3]=a,t}function Ue(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function ze(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function Je(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t[3]=n[3]*e[3],t}function Ge(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t[3]=n[3]/e[3],t}function Ye(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function Xe(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function We(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t[3]=Math.min(n[3],e[3]),t}function He(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t[3]=Math.max(n[3],e[3]),t}function Qe(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function Ze(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function Ke(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}function tr(t,n){var e=n[0]-t[0],r=n[1]-t[1],a=n[2]-t[2],i=n[3]-t[3];return Math.hypot(e,r,a,i)}function nr(t,n){var e=n[0]-t[0],r=n[1]-t[1],a=n[2]-t[2],i=n[3]-t[3];return e*e+r*r+a*a+i*i}function er(t){var n=t[0],e=t[1],r=t[2],a=t[3];return Math.hypot(n,e,r,a)}function rr(t){var n=t[0],e=t[1],r=t[2],a=t[3];return n*n+e*e+r*r+a*a}function ar(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function ir(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function or(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=e*e+r*r+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e*o,t[1]=r*o,t[2]=a*o,t[3]=i*o,t}function sr(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function ur(t,n,e,r){var a=e[0]*r[1]-e[1]*r[0],i=e[0]*r[2]-e[2]*r[0],o=e[0]*r[3]-e[3]*r[0],s=e[1]*r[2]-e[2]*r[1],u=e[1]*r[3]-e[3]*r[1],c=e[2]*r[3]-e[3]*r[2],h=n[0],f=n[1],l=n[2],d=n[3];return t[0]=f*c-l*u+d*s,t[1]=-h*c+l*o-d*i,t[2]=h*u-f*o+d*a,t[3]=-h*s+f*i-l*a,t}function cr(t,n,e,r){var a=n[0],i=n[1],o=n[2],s=n[3];return t[0]=a+r*(e[0]-a),t[1]=i+r*(e[1]-i),t[2]=o+r*(e[2]-o),t[3]=s+r*(e[3]-s),t}function hr(t,n){var e,r,a,i,o,s;n=n||1;do{o=(e=2*p()-1)*e+(r=2*p()-1)*r}while(o>=1);do{s=(a=2*p()-1)*a+(i=2*p()-1)*i}while(s>=1);var u=Math.sqrt((1-o)/s);return t[0]=n*e,t[1]=n*r,t[2]=n*a*u,t[3]=n*i*u,t}function fr(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3];return t[0]=e[0]*r+e[4]*a+e[8]*i+e[12]*o,t[1]=e[1]*r+e[5]*a+e[9]*i+e[13]*o,t[2]=e[2]*r+e[6]*a+e[10]*i+e[14]*o,t[3]=e[3]*r+e[7]*a+e[11]*i+e[15]*o,t}function lr(t,n,e){var r=n[0],a=n[1],i=n[2],o=e[0],s=e[1],u=e[2],c=e[3],h=c*r+s*i-u*a,f=c*a+u*r-o*i,l=c*i+o*a-s*r,d=-o*r-s*a-u*i;return t[0]=h*c+d*-o+f*-u-l*-s,t[1]=f*c+d*-s+l*-o-h*-u,t[2]=l*c+d*-u+h*-s-f*-o,t[3]=n[3],t}function dr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function mr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function pr(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function vr(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=n[0],s=n[1],u=n[2],c=n[3];return Math.abs(e-o)<=d*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=d*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-c)<=d*Math.max(1,Math.abs(i),Math.abs(c))}var Mr=ze,br=Je,gr=Ge,yr=tr,wr=nr,xr=er,Tr=rr,jr=function(){var t=Fe();return function(n,e,r,a,i,o){var s,u;for(e||(e=4),r||(r=0),u=a?Math.min(a*e+r,n.length):n.length,s=r;s<u;s+=e)t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],t[3]=n[s+3],i(t,t,o),n[s]=t[0],n[s+1]=t[1],n[s+2]=t[2],n[s+3]=t[3];return n}}();function Pr(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ar(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Vr(t,n,e){e*=.5;var r=Math.sin(e);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(e),t}function Sr(t,n){var e=2*Math.acos(n[3]),r=Math.sin(e/2);return r>d?(t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r):(t[0]=1,t[1]=0,t[2]=0),e}function Lr(t,n){var e=aa(t,n);return Math.acos(2*e*e-1)}function Dr(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=e[0],u=e[1],c=e[2],h=e[3];return t[0]=r*h+o*s+a*c-i*u,t[1]=a*h+o*u+i*s-r*c,t[2]=i*h+o*c+r*u-a*s,t[3]=o*h-r*s-a*u-i*c,t}function Er(t,n,e){e*=.5;var r=n[0],a=n[1],i=n[2],o=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u+o*s,t[1]=a*u+i*s,t[2]=i*u-a*s,t[3]=o*u-r*s,t}function Or(t,n,e){e*=.5;var r=n[0],a=n[1],i=n[2],o=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u-i*s,t[1]=a*u+o*s,t[2]=i*u+r*s,t[3]=o*u-a*s,t}function Nr(t,n,e){e*=.5;var r=n[0],a=n[1],i=n[2],o=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u+a*s,t[1]=a*u-r*s,t[2]=i*u+o*s,t[3]=o*u-i*s,t}function Rr(t,n){var e=n[0],r=n[1],a=n[2];return t[0]=e,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-e*e-r*r-a*a)),t}function Ir(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=Math.sqrt(e*e+r*r+a*a),s=Math.exp(i),u=o>0?s*Math.sin(o)/o:0;return t[0]=e*u,t[1]=r*u,t[2]=a*u,t[3]=s*Math.cos(o),t}function _r(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=Math.sqrt(e*e+r*r+a*a),s=o>0?Math.atan2(o,i)/o:0;return t[0]=e*s,t[1]=r*s,t[2]=a*s,t[3]=.5*Math.log(e*e+r*r+a*a+i*i),t}function $r(t,n,e){return _r(t,n),ra(t,t,e),Ir(t,t),t}function Fr(t,n,e,r){var a,i,o,s,u,c=n[0],h=n[1],f=n[2],l=n[3],m=e[0],p=e[1],v=e[2],M=e[3];return(i=c*m+h*p+f*v+l*M)<0&&(i=-i,m=-m,p=-p,v=-v,M=-M),1-i>d?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-r)*a)/o,u=Math.sin(r*a)/o):(s=1-r,u=r),t[0]=s*c+u*m,t[1]=s*h+u*p,t[2]=s*f+u*v,t[3]=s*l+u*M,t}function kr(t){var n=p(),e=p(),r=p(),a=Math.sqrt(1-n),i=Math.sqrt(n);return t[0]=a*Math.sin(2*Math.PI*e),t[1]=a*Math.cos(2*Math.PI*e),t[2]=i*Math.sin(2*Math.PI*r),t[3]=i*Math.cos(2*Math.PI*r),t}function qr(t,n){var e=n[0],r=n[1],a=n[2],i=n[3],o=e*e+r*r+a*a+i*i,s=o?1/o:0;return t[0]=-e*s,t[1]=-r*s,t[2]=-a*s,t[3]=i*s,t}function Cr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function Br(t,n){var e,r=n[0]+n[4]+n[8];if(r>0)e=Math.sqrt(r+1),t[3]=.5*e,e=.5/e,t[0]=(n[5]-n[7])*e,t[1]=(n[6]-n[2])*e,t[2]=(n[1]-n[3])*e;else{var a=0;n[4]>n[0]&&(a=1),n[8]>n[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;e=Math.sqrt(n[3*a+a]-n[3*i+i]-n[3*o+o]+1),t[a]=.5*e,e=.5/e,t[3]=(n[3*i+o]-n[3*o+i])*e,t[i]=(n[3*i+a]+n[3*a+i])*e,t[o]=(n[3*o+a]+n[3*a+o])*e}return t}function Ur(t,n,e,r){var a=.5*Math.PI/180;n*=a,e*=a,r*=a;var i=Math.sin(n),o=Math.cos(n),s=Math.sin(e),u=Math.cos(e),c=Math.sin(r),h=Math.cos(r);return t[0]=i*u*h-o*s*c,t[1]=o*s*h+i*u*c,t[2]=o*u*c-i*s*h,t[3]=o*u*h+i*s*c,t}function zr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Jr,Gr,Yr,Xr,Wr,Hr,Qr=ke,Zr=qe,Kr=Ce,ta=Be,na=Ue,ea=Dr,ra=Ze,aa=sr,ia=cr,oa=er,sa=oa,ua=rr,ca=ua,ha=or,fa=pr,la=vr,da=(Jr=Un(),Gr=Gn(1,0,0),Yr=Gn(0,1,0),function(t,n,e){var r=le(n,e);return r<-.999999?(de(Jr,Gr,n),Ie(Jr)<1e-6&&de(Jr,Yr,n),fe(Jr,Jr),Vr(t,Jr,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(de(Jr,n,e),t[0]=Jr[0],t[1]=Jr[1],t[2]=Jr[2],t[3]=1+r,ha(t,t))}),ma=(Xr=Pr(),Wr=Pr(),function(t,n,e,r,a,i){return Fr(Xr,n,a,i),Fr(Wr,e,r,i),Fr(t,Xr,Wr,2*i*(1-i)),t}),pa=(Hr=Mt(),function(t,n,e,r){return Hr[0]=e[0],Hr[3]=e[1],Hr[6]=e[2],Hr[1]=r[0],Hr[4]=r[1],Hr[7]=r[2],Hr[2]=-n[0],Hr[5]=-n[1],Hr[8]=-n[2],ha(t,Br(t,Hr))});function va(){var t=new m(8);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function Ma(t){var n=new m(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function ba(t,n,e,r,a,i,o,s){var u=new m(8);return u[0]=t,u[1]=n,u[2]=e,u[3]=r,u[4]=a,u[5]=i,u[6]=o,u[7]=s,u}function ga(t,n,e,r,a,i,o){var s=new m(8);s[0]=t,s[1]=n,s[2]=e,s[3]=r;var u=.5*a,c=.5*i,h=.5*o;return s[4]=u*r+c*e-h*n,s[5]=c*r+h*t-u*e,s[6]=h*r+u*n-c*t,s[7]=-u*t-c*n-h*e,s}function ya(t,n,e){var r=.5*e[0],a=.5*e[1],i=.5*e[2],o=n[0],s=n[1],u=n[2],c=n[3];return t[0]=o,t[1]=s,t[2]=u,t[3]=c,t[4]=r*c+a*u-i*s,t[5]=a*c+i*o-r*u,t[6]=i*c+r*s-a*o,t[7]=-r*o-a*s-i*u,t}function wa(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t}function xa(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ta(t,n){var e=Pr();Tn(e,n);var r=new m(3);return wn(r,n),ya(t,e,r),t}function ja(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}function Pa(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Aa(t,n,e,r,a,i,o,s,u){return t[0]=n,t[1]=e,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t}var Va=Kr;function Sa(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t}var La=Kr;function Da(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t}function Ea(t,n){var e=n[4],r=n[5],a=n[6],i=n[7],o=-n[0],s=-n[1],u=-n[2],c=n[3];return t[0]=2*(e*c+i*o+r*u-a*s),t[1]=2*(r*c+i*s+a*o-e*u),t[2]=2*(a*c+i*u+e*s-r*o),t}function Oa(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=.5*e[0],u=.5*e[1],c=.5*e[2],h=n[4],f=n[5],l=n[6],d=n[7];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=o*s+a*c-i*u+h,t[5]=o*u+i*s-r*c+f,t[6]=o*c+r*u-a*s+l,t[7]=-r*s-a*u-i*c+d,t}function Na(t,n,e){var r=-n[0],a=-n[1],i=-n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=s*o+h*r+u*i-c*a,l=u*o+h*a+c*r-s*i,d=c*o+h*i+s*a-u*r,m=h*o-s*r-u*a-c*i;return Er(t,n,e),r=t[0],a=t[1],i=t[2],o=t[3],t[4]=f*o+m*r+l*i-d*a,t[5]=l*o+m*a+d*r-f*i,t[6]=d*o+m*i+f*a-l*r,t[7]=m*o-f*r-l*a-d*i,t}function Ra(t,n,e){var r=-n[0],a=-n[1],i=-n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=s*o+h*r+u*i-c*a,l=u*o+h*a+c*r-s*i,d=c*o+h*i+s*a-u*r,m=h*o-s*r-u*a-c*i;return Or(t,n,e),r=t[0],a=t[1],i=t[2],o=t[3],t[4]=f*o+m*r+l*i-d*a,t[5]=l*o+m*a+d*r-f*i,t[6]=d*o+m*i+f*a-l*r,t[7]=m*o-f*r-l*a-d*i,t}function Ia(t,n,e){var r=-n[0],a=-n[1],i=-n[2],o=n[3],s=n[4],u=n[5],c=n[6],h=n[7],f=s*o+h*r+u*i-c*a,l=u*o+h*a+c*r-s*i,d=c*o+h*i+s*a-u*r,m=h*o-s*r-u*a-c*i;return Nr(t,n,e),r=t[0],a=t[1],i=t[2],o=t[3],t[4]=f*o+m*r+l*i-d*a,t[5]=l*o+m*a+d*r-f*i,t[6]=d*o+m*i+f*a-l*r,t[7]=m*o-f*r-l*a-d*i,t}function _a(t,n,e){var r=e[0],a=e[1],i=e[2],o=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=s*o+h*r+u*i-c*a,t[1]=u*o+h*a+c*r-s*i,t[2]=c*o+h*i+s*a-u*r,t[3]=h*o-s*r-u*a-c*i,s=n[4],u=n[5],c=n[6],h=n[7],t[4]=s*o+h*r+u*i-c*a,t[5]=u*o+h*a+c*r-s*i,t[6]=c*o+h*i+s*a-u*r,t[7]=h*o-s*r-u*a-c*i,t}function $a(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=e[0],u=e[1],c=e[2],h=e[3];return t[0]=r*h+o*s+a*c-i*u,t[1]=a*h+o*u+i*s-r*c,t[2]=i*h+o*c+r*u-a*s,t[3]=o*h-r*s-a*u-i*c,s=e[4],u=e[5],c=e[6],h=e[7],t[4]=r*h+o*s+a*c-i*u,t[5]=a*h+o*u+i*s-r*c,t[6]=i*h+o*c+r*u-a*s,t[7]=o*h-r*s-a*u-i*c,t}function Fa(t,n,e,r){if(Math.abs(r)<d)return ja(t,n);var a=Math.hypot(e[0],e[1],e[2]);r*=.5;var i=Math.sin(r),o=i*e[0]/a,s=i*e[1]/a,u=i*e[2]/a,c=Math.cos(r),h=n[0],f=n[1],l=n[2],m=n[3];t[0]=h*c+m*o+f*u-l*s,t[1]=f*c+m*s+l*o-h*u,t[2]=l*c+m*u+h*s-f*o,t[3]=m*c-h*o-f*s-l*u;var p=n[4],v=n[5],M=n[6],b=n[7];return t[4]=p*c+b*o+v*u-M*s,t[5]=v*c+b*s+M*o-p*u,t[6]=M*c+b*u+p*s-v*o,t[7]=b*c-p*o-v*s-M*u,t}function ka(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t}function qa(t,n,e){var r=n[0],a=n[1],i=n[2],o=n[3],s=e[4],u=e[5],c=e[6],h=e[7],f=n[4],l=n[5],d=n[6],m=n[7],p=e[0],v=e[1],M=e[2],b=e[3];return t[0]=r*b+o*p+a*M-i*v,t[1]=a*b+o*v+i*p-r*M,t[2]=i*b+o*M+r*v-a*p,t[3]=o*b-r*p-a*v-i*M,t[4]=r*h+o*s+a*c-i*u+f*b+m*p+l*M-d*v,t[5]=a*h+o*u+i*s-r*c+l*b+m*v+d*p-f*M,t[6]=i*h+o*c+r*u-a*s+d*b+m*M+f*v-l*p,t[7]=o*h-r*s-a*u-i*c+m*b-f*p-l*v-d*M,t}var Ca=qa;function Ba(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t}var Ua=aa;function za(t,n,e,r){var a=1-r;return Ua(n,e)<0&&(r=-r),t[0]=n[0]*a+e[0]*r,t[1]=n[1]*a+e[1]*r,t[2]=n[2]*a+e[2]*r,t[3]=n[3]*a+e[3]*r,t[4]=n[4]*a+e[4]*r,t[5]=n[5]*a+e[5]*r,t[6]=n[6]*a+e[6]*r,t[7]=n[7]*a+e[7]*r,t}function Ja(t,n){var e=Wa(n);return t[0]=-n[0]/e,t[1]=-n[1]/e,t[2]=-n[2]/e,t[3]=n[3]/e,t[4]=-n[4]/e,t[5]=-n[5]/e,t[6]=-n[6]/e,t[7]=n[7]/e,t}function Ga(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t}var Ya=oa,Xa=Ya,Wa=ua,Ha=Wa;function Qa(t,n){var e=Wa(n);if(e>0){e=Math.sqrt(e);var r=n[0]/e,a=n[1]/e,i=n[2]/e,o=n[3]/e,s=n[4],u=n[5],c=n[6],h=n[7],f=r*s+a*u+i*c+o*h;t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=(s-r*f)/e,t[5]=(u-a*f)/e,t[6]=(c-i*f)/e,t[7]=(h-o*f)/e}return t}function Za(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Ka(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]}function ti(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=n[0],f=n[1],l=n[2],m=n[3],p=n[4],v=n[5],M=n[6],b=n[7];return Math.abs(e-h)<=d*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-l)<=d*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-m)<=d*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-M)<=d*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-b)<=d*Math.max(1,Math.abs(c),Math.abs(b))}function ni(){var t=new m(2);return m!=Float32Array&&(t[0]=0,t[1]=0),t}function ei(t){var n=new m(2);return n[0]=t[0],n[1]=t[1],n}function ri(t,n){var e=new m(2);return e[0]=t,e[1]=n,e}function ai(t,n){return t[0]=n[0],t[1]=n[1],t}function ii(t,n,e){return t[0]=n,t[1]=e,t}function oi(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t}function si(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t}function ui(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t}function ci(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t}function hi(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function fi(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function li(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t}function di(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t}function mi(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function pi(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t}function vi(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t}function Mi(t,n){var e=n[0]-t[0],r=n[1]-t[1];return Math.hypot(e,r)}function bi(t,n){var e=n[0]-t[0],r=n[1]-t[1];return e*e+r*r}function gi(t){var n=t[0],e=t[1];return Math.hypot(n,e)}function yi(t){var n=t[0],e=t[1];return n*n+e*e}function wi(t,n){return t[0]=-n[0],t[1]=-n[1],t}function xi(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function Ti(t,n){var e=n[0],r=n[1],a=e*e+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=n[0]*a,t[1]=n[1]*a,t}function ji(t,n){return t[0]*n[0]+t[1]*n[1]}function Pi(t,n,e){var r=n[0]*e[1]-n[1]*e[0];return t[0]=t[1]=0,t[2]=r,t}function Ai(t,n,e,r){var a=n[0],i=n[1];return t[0]=a+r*(e[0]-a),t[1]=i+r*(e[1]-i),t}function Vi(t,n){n=n||1;var e=2*p()*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t}function Si(t,n,e){var r=n[0],a=n[1];return t[0]=e[0]*r+e[2]*a,t[1]=e[1]*r+e[3]*a,t}function Li(t,n,e){var r=n[0],a=n[1];return t[0]=e[0]*r+e[2]*a+e[4],t[1]=e[1]*r+e[3]*a+e[5],t}function Di(t,n,e){var r=n[0],a=n[1];return t[0]=e[0]*r+e[3]*a+e[6],t[1]=e[1]*r+e[4]*a+e[7],t}function Ei(t,n,e){var r=n[0],a=n[1];return t[0]=e[0]*r+e[4]*a+e[12],t[1]=e[1]*r+e[5]*a+e[13],t}function Oi(t,n,e,r){var a=n[0]-e[0],i=n[1]-e[1],o=Math.sin(r),s=Math.cos(r);return t[0]=a*s-i*o+e[0],t[1]=a*o+i*s+e[1],t}function Ni(t,n){var e=t[0],r=t[1],a=n[0],i=n[1],o=e*e+r*r;o>0&&(o=1/Math.sqrt(o));var s=a*a+i*i;s>0&&(s=1/Math.sqrt(s));var u=(e*a+r*i)*o*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function Ri(t){return t[0]=0,t[1]=0,t}function Ii(t){return"vec2("+t[0]+", "+t[1]+")"}function _i(t,n){return t[0]===n[0]&&t[1]===n[1]}function $i(t,n){var e=t[0],r=t[1],a=n[0],i=n[1];return Math.abs(e-a)<=d*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-i)<=d*Math.max(1,Math.abs(r),Math.abs(i))}var Fi=gi,ki=si,qi=ui,Ci=ci,Bi=Mi,Ui=bi,zi=yi,Ji=function(){var t=ni();return function(n,e,r,a,i,o){var s,u;for(e||(e=2),r||(r=0),u=a?Math.min(a*e+r,n.length):n.length,s=r;s<u;s+=e)t[0]=n[s],t[1]=n[s+1],i(t,t,o),n[s]=t[0],n[s+1]=t[1];return n}}();e.d(n,"glMatrix",(function(){return r})),e.d(n,"mat2",(function(){return a})),e.d(n,"mat2d",(function(){return i})),e.d(n,"mat3",(function(){return o})),e.d(n,"mat4",(function(){return s})),e.d(n,"quat",(function(){return h})),e.d(n,"quat2",(function(){return f})),e.d(n,"vec2",(function(){return l})),e.d(n,"vec3",(function(){return u})),e.d(n,"vec4",(function(){return c}))},function(t,n,e){var r;void 0===(r=function(t,n){"use strict";function e(t,n,e){let r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw"could not compile my shader:"+n+":"+t.getShaderInfoLog(r);return r}function r(t,n){for(var e=["webgl","experimental-webgl"],r=0;r<e.length;++r)try{return t.getContext("webgl",n)}catch(t){}return null}function a(t){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+t+"</div>"}Object.defineProperty(n,"__esModule",{value:!0}),n.loadTexture=function(t,n){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);const r=t.RGBA,a=t.RGBA,i=t.UNSIGNED_BYTE,o=new Uint8Array([0,0,255,255]);t.texImage2D(t.TEXTURE_2D,0,r,1,1,0,a,i,o);const s=new Image;return s.src=n,s.addEventListener("load",()=>{t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,r,a,i,s),t.generateMipmap(t.TEXTURE_2D)}),e},n.setupWebGL=function(t,n){var e=r(t,n);return e&&e instanceof WebGLRenderingContext||(document.getElementsByTagName("body")[0].innerHTML=a(i)),e},n.createShaderProgram=function(t,n,r){let a=t.createProgram(),i=e(t,n,t.VERTEX_SHADER),o=e(t,r,t.FRAGMENT_SHADER);if(t.attachShader(a,i),t.attachShader(a,o),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw"Could not link shader: "+t.getProgramInfoLog(a);return a},n.createShader=e,n.create3DContext=r,n.createErrorHTML=a;let i='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>'}.apply(n,[e,n]))||(t.exports=r)},function(t,n,e){var r,a;r=[e,n,e(0),e(4)],void 0===(a=function(t,n,e,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.SGNode=class{constructor(t,n){this.parent=null,this.scenegraph=t,this.setName(n),this.lights=[]}getNode(t){return this.name==t?this:null}setParent(t){this.parent=t}setScenegraph(t){this.scenegraph=t,t.addNode(this.name,this)}setName(t){this.name=t}getName(){return this.name}setTransform(t){throw new Error("Not supported")}setAnimationTransform(t){throw new Error("Not supported")}setMaterial(t){throw new Error("Not supported")}getMaterial(){throw new Error("Not supported")}addLight(t){this.lights.push(t)}getLights(){return this.lights}copyLight(t){let n=new r.Light;return n.setAmbient(t.getAmbient()),n.setSpecular(t.getSpecular()),n.setDiffuse(t.getDiffuse()),n.setPosition(e.vec3.fromValues(t.getPosition()[0],t.getPosition()[1],t.getPosition()[2])),n.setSpotDirection(e.vec3.fromValues(t.getSpotDirection()[0],t.getSpotDirection()[1],t.getSpotDirection()[2])),n.setSpotAngle(t.getSpotCutoff()),n}copyLights(){let t=[];return this.lights.forEach(n=>{t.push(this.copyLight(n))}),t}getTransformedLights(t){let n=this.copyLights();return n.forEach(n=>{let r=e.vec4.create();e.vec4.transformMat4(r,n.getPosition(),t),n.setPosition(e.vec3.fromValues(r[0],r[1],r[2]));let a=e.vec4.create();e.vec4.transformMat4(a,n.getSpotDirection(),t),e.vec4.normalize(a,a),n.setSpotDirection(e.vec3.fromValues(a[0],a[1],a[2]))}),n}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(0)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){let n;!function(t){t[t.Triangle=0]="Triangle",t[t.TriangleFan=1]="TriangleFan",t[t.TriangleStrip=2]="TriangleStrip",t[t.Lines=3]="Lines",t[t.LineStrip=4]="LineStrip",t[t.LineLoop=5]="LineLoop"}(n=t.FaceType||(t.FaceType={}));class r{constructor(){this.vertexData=[],this.indices=[],this.faceType=n.Triangle,this.minBounds=e.vec4.create(),this.maxBounds=e.vec4.create()}getFaceType(){return this.faceType}getNumIndices(){return this.indices.length}getVertexCount(){return this.vertexData.length}getMinimumBounds(){return e.vec4.clone(this.minBounds)}getMaximumBounds(){return e.vec4.clone(this.maxBounds)}getVertexAttributes(){return this.vertexData}getIndices(){return this.indices}setVertexData(t){this.vertexData=t,this.computeBoundingBox()}setPrimitives(t,n){this.indices=t,this.faceType=n}computeBoundingBox(){let t;if(this.vertexData.length<=0)return;if(!this.vertexData[0].hasData("position"))return;let n=[];for(let t of this.vertexData){let r=t.getData("position"),a=e.vec4.fromValues(0,0,0,1);for(let t=0;t<r.length;t++)a[t]=r[t];n.push(a)}for(this.minBounds=e.vec4.clone(n[0]),this.maxBounds=e.vec4.clone(n[0]),t=0;t<n.length;t++){let e=n[t];for(let t=0;t<3;t++)e[t]<this.minBounds[t]&&(this.minBounds[t]=e[t]),e[t]>this.maxBounds[t]&&(this.maxBounds[t]=e[t])}}computeNormals(){let t,n;if(this.vertexData.length<=0)return;if(!this.vertexData[0].hasData("position"))return;if(!this.vertexData[0].hasData("normal"))return;let r=[];this.vertexData.forEach(t=>{let n=t.getData("position"),a=e.vec4.fromValues(0,0,0,1);for(let t=0;t<n.length;t++)a[t]=n[t];r.push(a)});let a=[];for(let t=0;t<r.length;t++)a.push(e.vec4.fromValues(0,0,0,0));for(let t=0;t<this.indices.length;t+=3){let i=e.vec3.fromValues(0,0,0),o=[0,0,0];for(let n=0;n<3;n++)o[n]=this.indices[t+n];for(let t=0;t<3;t++)for(let n=0;n<3;n++)i[n]+=(r[o[t]][(n+1)%3]-r[o[(t+1)%3]][(n+1)%3])*(r[o[t]][(n+2)%3]+r[o[(t+1)%3]][(n+2)%3]);for(e.vec3.normalize(i,i),n=0;n<3;n++)a[o[n]]=e.vec4.add(a[o[n]],a[o[n]],e.vec4.fromValues(i[0],i[1],i[2],0))}for(t=0;t<a.length;t++){let n=e.vec3.fromValues(a[t][0],a[t][1],a[t][2]);e.vec3.normalize(n,n),a[t]=e.vec4.fromValues(n[0],n[1],n[2],0)}for(t=0;t<this.vertexData.length;t++)this.vertexData[t].setData("normal",[a[t][0],a[t][1],a[t][2]])}convertToWireframe(){let t,e=new r;e.setVertexData(this.vertexData);let a=[];switch(this.faceType){case n.Triangle:for(t=0;t<this.indices.length;t+=3)a.push(this.indices[t]),a.push(this.indices[t+1]),a.push(this.indices[t+1]),a.push(this.indices[t+2]),a.push(this.indices[t+2]),a.push(this.indices[t]);break;case n.TriangleFan:for(t=1;t<this.indices.length-1;t+=1)a.push(this.indices[0]),a.push(this.indices[t]),a.push(this.indices[t]),a.push(this.indices[t+1]),a.push(this.indices[0]),a.push(this.indices[t+1]);break;case n.TriangleStrip:for(t=0;t<this.indices.length-2;t++)a.push(this.indices[t]),a.push(this.indices[t+1]),a.push(this.indices[t+1]),a.push(this.indices[t+2]),a.push(this.indices[t+2]),a.push(this.indices[t])}return e.setPrimitives(a,n.Lines),e}}t.PolygonMesh=r;class a{constructor(t){this.mesh=t}getMesh(){return this.mesh}}t.DecoratedMesh=a;t.CanonicalMesh=class extends a{constructor(t){super(t),this.resizeAndCenter()}resizeAndCenter(){let t=this.mesh.getVertexAttributes();if(this.mesh.getVertexCount()<3)return;let n,r=e.vec3.fromValues(0,0,0),a=e.vec3.fromValues(t[0].getData("position")[0],t[0].getData("position")[1],t[0].getData("position")[2]),i=e.vec3.fromValues(a[0],a[1],a[2]);t[0].getData("position").length;t.forEach(t=>{let e=t.getData("position");for(n=0;n<e.length;n++)e[n]<a[n]&&(a[n]=e[n]),e[n]>i[n]&&(i[n]=e[n])}),e.vec3.add(r,a,i),e.vec3.scale(r,r,.5);let o=Math.max(i[0]-a[0],i[1]-a[1],i[2]-a[2]),s=e.mat4.create();for(e.mat4.scale(s,s,e.vec3.fromValues(1/o,1/o,1/o)),e.mat4.translate(s,s,e.vec3.negate(r,r)),n=0;n<t.length;n++){let r=t[n].getData("position"),a=e.vec4.fromValues(r[0],r[1],r[2],1);e.vec4.transformMat4(a,a,s),t[n].setData("position",[a[0],a[1],a[2],a[3]])}}}}(n.Mesh||(n.Mesh={}))}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(0)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Light=class{constructor(){this.ambient=e.vec3.fromValues(0,0,0),this.diffuse=e.vec3.fromValues(0,0,0),this.specular=e.vec3.fromValues(0,0,0),this.position=e.vec4.fromValues(0,0,0,1),this.spotDirection=e.vec4.fromValues(0,0,0,0),this.spotCutoff=0}setAmbient(t){this.ambient=e.vec3.fromValues(t[0],t[1],t[2])}setDirection(t){this.position=e.vec4.fromValues(t[0],t[1],t[2],0)}setSpotDirection(t){this.spotDirection=e.vec4.fromValues(t[0],t[1],t[2],0)}setDiffuse(t){this.diffuse=e.vec3.fromValues(t[0],t[1],t[2])}setSpecular(t){this.specular=e.vec3.fromValues(t[0],t[1],t[2])}setSpotAngle(t){this.spotCutoff=t}setPosition(t){this.position=e.vec4.fromValues(t[0],t[1],t[2],1)}getAmbient(){return e.vec3.fromValues(this.ambient[0],this.ambient[1],this.ambient[2])}getDiffuse(){return e.vec3.fromValues(this.diffuse[0],this.diffuse[1],this.diffuse[2])}getSpecular(){return e.vec3.fromValues(this.specular[0],this.specular[1],this.specular[2])}getPosition(){return e.vec4.fromValues(this.position[0],this.position[1],this.position[2],this.position[3])}getSpotDirection(){return e.vec4.fromValues(this.spotDirection[0],this.spotDirection[1],this.spotDirection[2],this.spotDirection[3])}getSpotCutoff(){return this.spotCutoff}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(6),e(1),e(20)],void 0===(a=function(t,n,e,r,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=0,o=-1;!function(){let t,n,s;window.onload=u=>{var c=document.querySelector("#glCanvas");if(c)if(null!=(t=r.setupWebGL(c,{antialias:!1,alpha:!1,depth:!0,stencil:!1}))){n=new e.View(t),(s=new a.Controller(n)).go();var h=function(){if(-1==o&&(o=(new Date).getTime()),(i+=1)>=100){let t=(new Date).getTime(),n=1e3*i/(t-o);o=t,document.getElementById("frameratedisplay").innerHTML="Frame rate: "+n.toFixed(1),i=0}n.animate(),n.draw(),requestAnimationFrame(h)};h()}else alert("Unable to initialize WebGL. Your browser or machine may not support it.");else console.log("Failed to retrieve the <canvas> element")},window.onbeforeunload=t=>n.freeMeshes()}()}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(0),e(1),e(7),e(8),e(9),e(10),e(12),e(19)],void 0===(a=function(t,n,e,r,a,i,o,s,u,c){"use strict";var h;Object.defineProperty(n,"__esModule",{value:!0}),function(t){t[t.Front=0]="Front",t[t.BirdsEye=1]="BirdsEye",t[t.TurnTable=2]="TurnTable",t[t.CockPit=3]="CockPit"}(h||(h={}));n.View=class{constructor(t){this.gl=t,this.time=0,this.modelview=new a.Stack,this.scenegraph=null,this.gl.clearColor(.9,.9,.7,1),this.proj=e.mat4.perspective(e.mat4.create(),Math.PI/2,1,.1,1e3),this.gl.viewport(0,0,400,400),this.radius=100,this.viewType=h.Front;let n=this;document.addEventListener("keydown",(function(t){switch(t.key){case"t":n.viewType=h.TurnTable;break;case"f":n.viewType=h.Front;break;case"o":n.viewType=h.BirdsEye;break;case"a":n.viewType=h.CockPit}}))}initShaders(t,n){this.shaderProgram=r.createShaderProgram(this.gl,t,n),this.gl.useProgram(this.shaderProgram),this.shaderLocations=new o.ShaderLocationsVault(this.gl,this.shaderProgram)}initScenegraph(){u.ScenegraphJSONImporter.importJSON(new i.VertexPNTProducer,this.json2()).then(t=>{let n=new Map;n.set("vPosition","position"),n.set("vNormal","normal");let e=new s.ScenegraphRenderer(this.gl,this.shaderLocations,n);this.scenegraph=t,this.scenegraph.setRenderer(e)})}initPlaneAttribs(){c.PlaneAttributesImporter.downloadPlaneAttributes("models/camerapath.txt").then(t=>{this.planeAttribs=t,this.numPlanePositions=t.getNumPositions()})}json2(){return`\n        {\n            "instances": [\n                {\n                    "name":"sphere",\n                    "path":"models/sphere.obj"\n                },\n                {\n                    "name":"box",\n                    "path":"models/box.obj"\n                },\n                {\n                    "name":"cylinder",\n                    "path":"models/cylinder.obj"\n                },\n                {\n                    "name":"cone",\n                    "path":"models/cone.obj"\n                },\n                {\n                    "name":"plane",\n                    "path":"models/aeroplane.obj"\n                }\n            ],\n            "root":\n            {\n                "type":"group",\n                "lights": [\n                    {\n                      "ambient": [\n                        0.4,\n                        0.4,\n                        0.4\n                      ],\n                      "diffuse": [\n                        0.4,\n                        0.4,\n                        0.4\n                      ],\n                      "specular": [\n                        0.4,\n                        0.4,\n                        0.4\n                      ],\n                      "position": [\n                        0.0,\n                        100.0,\n                        -27.5,\n                        1.0\n                      ],\n                      "spotdirection": [\n                        0.0,\n                        0.0,\n                        0.0,\n                        0.0\n                      ],\n                      "spotcutoff": 180.0\n                    },\n                    {\n                        "ambient": [\n                          0.4,\n                          0.4,\n                          0.4\n                        ],\n                        "diffuse": [\n                          0.4,\n                          0.4,\n                          0.4\n                        ],\n                        "specular": [\n                          0.4,\n                          0.4,\n                          0.4\n                        ],\n                        "position": [\n                          80.0, \n                          175.0, \n                          -27.5,\n                          1.0\n                        ],\n                        "spotdirection": [\n                          0.0,\n                          0.0,\n                          0.0,\n                          0.0\n                        ],\n                        "spotcutoff": 180.0\n                      }\n                  ],\n                "children":[${this.drawObject1()}, ${this.drawObject2()}, ${this.drawObject3()}, \n                    ${this.drawObject4()}, ${this.drawObject5()}, ${this.drawObject6()}, \n                    ${this.drawObject7()}, \n                    ${this.drawObject8()},\n                    ${this.drawObject9()},\n                    ${this.drawObject10()},\n                    ${this.drawObject11()},\n                    ${this.drawObject12()},\n                    ${this.drawObject13()},\n                    ${this.drawObject14()},\n                    ${this.drawObject15()},\n                    ${this.drawObject16()},\n                    ${this.drawObject17()},\n                    ${this.drawObject18()},\n                    ${this.drawObject19()},\n                    ${this.drawObject20()},\n                    ${this.drawObject21()},\n                    ${this.drawObject22()},\n                    ${this.drawObject23()},\n                    ${this.drawObject24()},\n                    ${this.drawPlane()}]\n\n            }\n        }\n        `}drawPlane(){return`\n            {\n                "type":"transform",\n                "name":"aeroplane",\n                "transform":[\n                    {"rotate":[90,1,0,0]}\n                ],\n                "child": ${this.objectJson("plane",[3,3,3],[0,1,0],4)},\n                "lights": [\n                    {\n                        "ambient": [\n                          0.0,\n                          0.0,\n                          0.0\n                        ],\n                        "diffuse": [\n                          1.0,\n                          1.0,\n                          0.0\n                        ],\n                        "specular": [\n                          1.0,\n                          1.0,\n                          0.0\n                        ],\n                        "position": [\n                          0.0, \n                          1.5, \n                          0.0,\n                          1.0\n                        ],\n                        "spotdirection": [\n                          0.0,\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "spotcutoff": 20.0\n                      },\n                      {\n                        "ambient": [\n                          0.0,\n                          0.0,\n                          0.0\n                        ],\n                        "diffuse": [\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "specular": [\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "position": [\n                          3.0, \n                          1.5, \n                          0.0,\n                          1.0\n                        ],\n                        "spotdirection": [\n                          0.0,\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "spotcutoff": 20.0\n                      },\n                      {\n                        "ambient": [\n                          0.0,\n                          0.0,\n                          0.0\n                        ],\n                        "diffuse": [\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "specular": [\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "position": [\n                          -3.0, \n                          1.5, \n                          0.0,\n                          1.0\n                        ],\n                        "spotdirection": [\n                          0.0,\n                          1.0,\n                          0.0,\n                          0.0\n                        ],\n                        "spotcutoff": 20.0\n                      }\n                ]\n            }\n        `}drawObject1(){return`\n            {\n                "type":"transform",\n                "name":"place-obj1",\n                "transform":[\n                    {"translate":[5,0,-5]}\n                ],\n                "child": ${this.drawObject1Type(1)}\n            }\n        `}drawObject2(){return`\n            {\n                "type":"transform",\n                "name":"place-obj2",\n                "transform":[\n                    {"translate":[20,0,-5]}\n                ],\n                "child": ${this.drawObject1Type(2)}\n            }\n        `}drawObject3(){return`\n            {\n                "type":"transform",\n                "name":"place-obj3",\n                "transform":[\n                    {"translate":[12.5,0,-27.5]}\n                ],\n                "child": ${this.objectJson("box",[15,20,-35],[.6,217/255,234/255],3)}\n            }\n        `}drawObject4(){return`\n            {\n                "type":"transform",\n                "name":"place-obj4",\n                "transform":[\n                    {"translate":[30,0,-27.5]}\n                ],\n                "child": ${this.objectJson("box",[20,20,-35],[.5,0,.5],4)}\n            }\n        `}drawObject5(){return`\n            {\n                "type":"transform",\n                "name":"place-obj5",\n                "transform":[\n                    {"translate":[12.5, 0, -57.5]}\n                ],\n                "child": ${this.object5()}\n            }\n        `}drawObject6(){return`\n            {\n                "type":"transform",\n                "name":"place-obj6",\n                "transform":[\n                    {"translate":[50,0,-50]}\n                ],\n                "child": ${this.objectJson("box",[50,20,-10],[1,1,0],6)}\n            }\n        `}drawObject7(){return`\n            {\n                "type":"transform",\n                "name":"place-obj7",\n                "transform":[\n                    {"translate":[47.5,0,-35]}\n                ],\n                "child": ${this.objectJson("box",[15,20,-20],[1,0,0],7)}\n            }\n        `}drawObject8(){return`\n            {\n                "type":"transform",\n                "name":"place-obj8",\n                "transform":[\n                    {"translate":[47.5,0,-17.5]}\n                ],\n                "child": ${this.boxPlusMinaret([15,50,-15],[.5,.5,.5],[15,10,-15],[1,1,1],[15,10,-15],[170/255,130/255,.2],8)}\n            }\n        `}drawObject9(){return`\n            {\n                "type":"transform",\n                "name":"place-obj9",\n                "transform":[\n                    {"translate":[32.5,0,-5]}\n                ],\n                "child": ${this.objectJson("box",[15,20,-10],[1,1,0],9)}\n            }\n        `}drawObject10(){return`\n            {\n                "type":"transform",\n                "name":"place-obj10",\n                "transform":[\n                    {"translate":[60,0,-27.5]}\n                ],\n                "child": ${this.objectJson("box",[10,20,-35],[.6,217/255,234/255],10)}\n            }\n        `}drawObject11(){return`\n            {\n                "type":"transform",\n                "name":"place-obj11",\n                "transform":[\n                    {"translate":[70,0,-27.5]}\n                ],\n                "child": ${this.objectJson("box",[10,20,-15],[1,0,0],11)}\n            }\n        `}drawObject12(){return`\n            {\n                "type":"transform",\n                "name":"place-obj12",\n                "transform":[\n                    {"translate":[70,0,-40]}\n                ],\n                "child": ${this.drawObject1Type(12)}\n            }\n        `}drawObject13(){return`\n            {\n                "type":"transform",\n                "name":"place-obj13",\n                "transform":[\n                    {"translate":[70,0,-15]}\n                ],\n                "child": ${this.drawObject1Type(13)}\n            }\n        `}drawObject14(){return`\n            {\n                "type":"transform",\n                "name":"place-obj14",\n                "transform":[\n                    {"translate":[80,0,-27.5]}\n                ],\n                "child": ${this.objectJson("box",[10,20,-35],[.6,217/255,234/255],14)}\n            }\n        `}drawObject15(){return`\n            {\n                "type":"transform",\n                "name":"place-obj15",\n                "transform":[\n                    {"translate":[80,0,-50]}\n                ],\n                "child": ${this.drawObject1Type(15)}\n            }\n        `}drawObject16(){return`\n            {\n                "type":"transform",\n                "name":"place-obj16",\n                "transform":[\n                    {"translate":[80,0,-5]}\n                ],\n                "child": ${this.drawObject1Type(16)}\n            }\n        `}drawObject17(){return`\n            {\n                "type":"transform",\n                "name":"place-obj17",\n                "transform":[\n                    {"translate":[103,0,-27]}\n                ],\n                "child": ${this.objectJson("box",[36,20,-10],[1,0,0],17)}\n            }\n        `}drawObject18(){return`\n            {\n                "type":"transform",\n                "name":"place-obj18",\n                "transform":[\n                    {"translate":[95,0,-50]}\n                ],\n                "child": ${this.objectJson("box",[20,20,-10],[1,0,0],18)}\n            }\n        `}drawObject19(){return`\n            {\n                "type":"transform",\n                "name":"place-obj19",\n                "transform":[\n                    {"translate":[113,0,-50]}\n                ],\n                "child": ${this.drawMinaret([25,40,-25],[1,1,1],[25,50,-25],[170/255,130/255,.2],19)}\n            }\n        `}drawObject20(){return`\n            {\n                "type":"transform",\n                "name":"place-obj20",\n                "transform":[\n                    {"translate":[131,0,-50]}\n                ],\n                "child": ${this.objectJson("box",[20,20,-10],[1,0,0],20)}\n            }\n        `}drawObject21(){return`\n            {\n                "type":"transform",\n                "name":"place-obj21",\n                "transform":[\n                    {"translate":[136,0,-42]}\n                ],\n                "child": ${this.drawObject1Type(21)}\n            }\n        `}drawObject22(){return`\n            {\n                "type":"transform",\n                "name":"place-obj21",\n                "transform":[\n                    {"translate":[126,0,-27]}\n                ],\n                "child": ${this.drawObject1Type(22)}\n            }\n        `}drawObject23(){return`\n            {\n                "type":"transform",\n                "name":"place-obj20",\n                "transform":[\n                    {"translate":[136,0,-29.5]}\n                ],\n                "child": ${this.objectJson("box",[10,20,-15],[1,0,0],23)}\n            }\n        `}drawObject24(){return`\n            {\n                "type":"transform",\n                "name":"place-obj20",\n                "transform":[\n                    {"translate":[12.5,0,-5]}\n                ],\n                "child": ${this.objectJson("box",[5,20,-10],[1,0,0],24)}\n            }\n        `}drawObject1Type(t){return this.boxPlusMinaret([10,50,-10],[.5,.5,.5],[10,5,-10],[1,1,1],[10,10,-10],[170/255,130/255,.2],t)}boxPlusMinaret(t,n,e,r,a,i,o){return`\n        {\n            "type":"group",\n            "children":[${this.objectJson("box",t,n,o)},\n                {\n                    "type":"transform",\n                    "name":"cylinder-obj${o}",\n                    "transform":[\n                        {"translate":[0,50,0]}\n                    ],\n                    "child": ${this.drawMinaret(e,r,a,i,o)}\n                }\n            ]\n        }`}object5(){let t=[20,40,-20],n=[8,30,-8],e=[.5,.5,.5],r=[8,10,-8],a=[1,0,1];return`\n        {\n            "type":"group",\n            "children":[${this.objectJson("box",[25,20,-25],[.5,.5,.5],5)},\n                {\n                    "type":"transform",\n                    "name":"cylinder-obj5",\n                    "transform":[\n                        {"translate":[0,20,0]}\n                    ],\n                    "child": \n                    {\n                        "type":"group",\n                        "children":[${this.objectJson("cylinder",[22,25,-22],[1,0,0],5)},\n                        {\n                            "type":"transform",\n                            "name":"mainMinaret-obj5",\n                            "transform":[\n                                {"translate":[0,12.5,0]}\n                            ],\n                            "child": ${this.drawMinaret(t,[1,1,1],[20,20,-20],[1,0,1],5)}\n                        },\n                        {\n                            "type":"transform",\n                            "name":"mini-Minaret1-obj5",\n                            "transform":[\n                                {"translate":[${t[0]/2}, 10, 0]}\n                            ],\n                            "child": ${this.drawMinaret(n,e,r,a,5)}\n                        },\n                        {\n                            "type":"transform",\n                            "name":"mini-Minaret2-obj5",\n                            "transform":[\n                                {"translate":[0,10,${-t[0]/2}]}\n                            ],\n                            "child": ${this.drawMinaret(n,e,r,a,5)}\n                        },\n                        {\n                            "type":"transform",\n                            "name":"mini-Minaret1-obj5",\n                            "transform":[\n                                {"translate":[${-t[0]/2},10,0]}\n                            ],\n                            "child": ${this.drawMinaret(n,e,r,a,5)}\n                        },\n                        {\n                            "type":"transform",\n                            "name":"mini-Minaret1-obj5",\n                            "transform":[\n                                {"translate":[0,10,${t[0]/2}]}\n                            ],\n                            "child": ${this.drawMinaret(n,e,r,a,5)}\n                        }\n                        ]\n                    }\n                }\n            ]\n        }`}drawMinaret(t,n,e,r,a){return`{\n            "type":"group",\n            "children":[${this.objectJson("cylinder",t,n,a)},\n                {\n                    "type":"transform",\n                    "name":"cone-obj${a}",\n                    "transform":[\n                        {"translate":[0,${t[1]},0]}\n                    ],\n                    "child": ${this.objectJson("cone",e,r,a)}\n                }\n            ]\n        }`}objectJson(t,n,e,r){let a=.25,i=2;return"box"===t&&(a=.5,i=1),`{\n            "type":"transform",\n            "name":"${t}-obj${r}",\n            "transform":[\n                {"scale":[${n[0]}, ${i*n[1]}, ${n[2]}]},\n                {"translate":[0,${a},0]}\n            ],\n            "child": {\n                    "type":"object",\n                    "instanceof":"${t}",\n                    "material": {\n                        "ambient":[${e[0]/1.5}, ${e[1]/1.5}, ${e[2]/1.5}],\n                        "specular":[${e[0]}, ${e[1]}, ${e[2]}],\n                        "diffuse":[${e[0]}, ${e[1]}, ${e[2]}],\n                        "shininess": 10\n                    }\n            }\n            \n        }`}json(){return'\n        {\n            "instances": [\n                {\n                    "name":"sphere",\n                    "path":"models/sphere.obj"\n                },\n                {\n                    "name":"box",\n                    "path":"models/box.obj"\n                },\n                {\n                    "name":"cylinder",\n                    "path":"models/cylinder.obj"\n                },\n                {\n                    "name":"cone",\n                    "path":"models/cone.obj"\n                }\n            ],\n            "root": {\n                "type":"group",\n                "children":[\n                {\n                    "type":"transform",\n                    "transform":[\n                        {"scale":[50,5,50]}\n                    ],\n                    "child": {\n                        "type":"object",\n                        "instanceof":"box",\n                        "material": {\n                            "color":[0.5,0.5,0.5]\n                        }\n                    }\n                },\n                {\n                    "type":"transform",\n                    "name":"face",\n                    "transform":[\n                        {"translate":[0,25,0]}\n                    ],        \n                    "child": {\n                        "type":"group",\n                        "children": [\n                            {\n                                "type":"transform",\n                                "name":"actualface",\n                                "transform":[\n                                    {"scale":[20,25,20]}\n                                ],\n                                "child": {\n                                    "type":"object",\n                                    "instanceof":"sphere",\n                                    "material": {\n                                        "color":[1,1,0.8]\n                                    }\n                                }\n                            },\n                            {\n                                "type":"transform",\n                                "name":"lefteye",\n                                "transform":[\n                                    {"translate":[7,15,12]},\n                                    {"scale":[3,4,3]}\n                                ],\n                                "child": {\n                                    "type":"object",\n                                    "instanceof":"sphere",\n                                    "material": {\n                                        "color":[0,0,0]\n                                    }\n                                }\n                            },\n                            {\n                                "type":"transform",\n                                "name":"righteye",\n                                "transform":[\n                                    {"translate":[-7,15,12]},\n                                    {"scale":[3,4,3]}\n                                ],\n                                "child": {\n                                    "type":"object",\n                                    "instanceof":"sphere",\n                                    "material": {\n                                        "color":[0,0,0]\n                                    }\n                                }\n                            },\n                            {\n                                "type":"transform",\n                                "name":"nose",\n                                "transform":[\n                                    {"translate":[0,10,10]},\n                                    {"rotate":[90,1,0,0]},\n                                    {"scale":[5,20,5]}\n                                ],\n                                "child": {\n                                    "type":"object",\n                                    "instanceof":"cylinder",\n                                    "material": {\n                                        "color":[1,0,0]\n                                    }\n                                }\n                            },\n                            {\n                                "type":"transform",\n                                "name":"hat",\n                                "transform":[\n                                    {"translate":[0,20,0]},\n                                    {"scale":[10,25,10]}\n                                ],\n                                "child": {\n                                    "type":"object",\n                                    "instanceof":"cone",\n                                    "material": {\n                                        "color":[1,0,1]\n                                    }\n                                }\n                            }\n                        ]\n                    }\n                }]\n            }\n        }\n        '}animate(){this.time+=1,null!=this.scenegraph&&this.scenegraph.animate(this.time,this.planeAttribs,this.numPlanePositions,this.generateLookAtMatrix(!1)),this.draw()}draw(){if(this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.enable(this.gl.DEPTH_TEST),null==this.scenegraph)return;for(this.gl.useProgram(this.shaderProgram);!this.modelview.isEmpty();)this.modelview.pop();switch(this.modelview.push(e.mat4.create()),this.modelview.push(e.mat4.clone(this.modelview.peek())),this.viewType){case h.TurnTable:e.mat4.lookAt(this.modelview.peek(),e.vec3.fromValues(80+this.radius*Math.sin(.01*this.time),140,this.radius*Math.cos(.01*this.time)-27.5),e.vec3.fromValues(80,20,-27.5),e.vec3.fromValues(0,1,0));break;case h.BirdsEye:e.mat4.lookAt(this.modelview.peek(),e.vec3.fromValues(80,175,-27.5),e.vec3.fromValues(80,0,-27.5),e.vec3.fromValues(0,0,-1));break;case h.Front:e.mat4.lookAt(this.modelview.peek(),e.vec3.fromValues(80,90,60),e.vec3.fromValues(60,20,-27.5),e.vec3.fromValues(0,1,0));break;case h.CockPit:e.mat4.multiply(this.modelview.peek(),this.generateLookAtMatrix(!0),this.modelview.peek());break;default:e.mat4.lookAt(this.modelview.peek(),e.vec3.fromValues(100,150,160),e.vec3.fromValues(80,20,-27.5),e.vec3.fromValues(0,1,0))}let t=this.scenegraph.findLights(this.modelview);for(let n=0;n<t.length;n++){let e="light["+n+"].ambient",r="light["+n+"].diffuse",a="light["+n+"].specular",i="light["+n+"].position",o="light["+n+"].spotDirection",s="light["+n+"].spotCutoff";this.gl.uniform4fv(this.shaderLocations.getUniformLocation(i),t[n].getPosition()),this.gl.uniform3fv(this.shaderLocations.getUniformLocation(e),t[n].getAmbient()),this.gl.uniform3fv(this.shaderLocations.getUniformLocation(r),t[n].getDiffuse()),this.gl.uniform3fv(this.shaderLocations.getUniformLocation(a),t[n].getSpecular()),this.gl.uniform4fv(this.shaderLocations.getUniformLocation(o),t[n].getSpotDirection()),this.gl.uniform1f(this.shaderLocations.getUniformLocation(s),t[n].getSpotCutoff())}this.gl.uniformMatrix4fv(this.shaderLocations.getUniformLocation("projection"),!1,this.proj),this.scenegraph.draw(this.modelview)}freeMeshes(){this.scenegraph.dispose()}setFeatures(t){}generateLookAtMatrix(t){let n=this.time%this.numPlanePositions,r=(n+1)%this.numPlanePositions,a=this.planeAttribs.getPositionByIndex(n),i=this.planeAttribs.getPositionByIndex(r),o=e.vec3.create();if(t){let t=e.vec3.create();t=e.vec3.subtract(t,a,i),t=e.vec3.normalize(t,t),t=e.vec3.scale(t,t,4.5),e.vec3.subtract(o,a,t)}else o=a;let s=e.vec3.create();e.vec3.normalize(s,e.vec3.subtract(s,a,i));let u=e.vec3.create();e.vec3.normalize(u,this.planeAttribs.getUpVecByIndex(n));let c=e.vec3.create();e.vec3.normalize(c,e.vec3.cross(c,u,s));let h=e.mat4.fromValues(c[0],c[1],c[2],-e.vec3.dot(o,c),u[0],u[1],u[2],-e.vec3.dot(o,u),s[0],s[1],s[2],-e.vec3.dot(o,s),0,0,0,1);return e.mat4.transpose(h,h)}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r;void 0===(r=function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Stack=class{constructor(){this.list=[]}push(t){this.list.push(t)}pop(){if(0==this.list.length)throw new Error("Stack is empty: nothing to pop");return this.list.pop()}peek(){if(0==this.list.length)throw new Error("Stack is empty: nothing to peek");return this.list[this.list.length-1]}isEmpty(){return 0==this.list.length}}}.apply(n,[e,n]))||(t.exports=r)},function(t,n,e){var r,a;r=[e,n,e(0)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r{constructor(){this.position=e.vec4.fromValues(0,0,0,1),this.texcoord=e.vec4.fromValues(0,0,0,1)}hasData(t){switch(t){case"position":case"normal":case"texcoord":return!0;default:return!1}}getData(t){let n;switch(t){case"position":n=[this.position[0],this.position[1],this.position[2],this.position[3]];break;case"normal":n=[this.normal[0],this.normal[1],this.normal[2],this.normal[3]];break;case"texcoord":n=[this.texcoord[0],this.texcoord[1]];break;default:throw new Error("No attribute: "+t+" found!")}return n}setData(t,n){switch(t){case"position":this.position=e.vec4.fromValues(0,0,0,1);for(let t=0;t<n.length;t++)this.position[t]=n[t];break;case"normal":this.normal=e.vec4.fromValues(0,0,0,0);for(let t=0;t<n.length;t++)this.normal[t]=n[t];break;case"texcoord":this.texcoord=e.vec4.fromValues(0,0,0,1);for(let t=0;t<n.length;t++)this.texcoord[t]=n[t];break;default:throw new Error("Attribute: "+t+" unsupported!")}}getAllAttributes(){return["position","color","texcoord"]}}n.VertexPNT=r;n.VertexPNTProducer=class{produce(){return new r}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r;void 0===(r=function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ShaderLocationsVault=class{constructor(t,n){this.attribs=new Map,this.uniforms=new Map,this.getAllShaderVariables(t,n)}getAllShaderVariables(t,n){let e=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);for(let r=0;r<e;r++){let e=t.getActiveUniform(n,r),a=t.getUniformLocation(n,e.name);this.addUniformLocation(e.name,a)}let r=t.getProgramParameter(n,t.ACTIVE_ATTRIBUTES);for(let e=0;e<r;e++){let r=t.getActiveAttrib(n,e),a=t.getAttribLocation(n,r.name);this.addAttribLocation(r.name,a)}}addAttribLocation(t,n){this.attribs.set(t,n)}addUniformLocation(t,n){this.uniforms.set(t,n)}getAttribLocation(t){return this.attribs.has(t)?this.attribs.get(t):-1}getUniformLocation(t){return this.uniforms.has(t)?this.uniforms.get(t):-1}}}.apply(n,[e,n]))||(t.exports=r)},function(t,n,e){var r,a;r=[e,n,e(11),e(1),e(0)],void 0===(a=function(t,n,e,r,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ScenegraphRenderer=class{constructor(t,n,e){this.gl=t,this.shaderVarsToVertexAttribs=e,this.meshRenderers=new Map,this.shaderLocations=n}addMesh(t,n){if(t in this.meshRenderers)return;if(n.getVertexCount()<=0)return;let r=n.getVertexAttributes()[0];for(let[t,n]of this.shaderVarsToVertexAttribs)if(!r.hasData(n))throw new Error("Mesh does not have vertex attribute "+n);let a=new e.RenderableMesh(this.gl,name);a.initMeshForRendering(this.shaderVarsToVertexAttribs,n),this.meshRenderers.set(t,a)}addTexture(t,n){let e;n.substring(n.indexOf(".")+1);e=r.loadTexture(this.gl,n),this.textures.set(t,e)}draw(t,n){t.draw(this,n)}dispose(){for(let t of this.meshRenderers.values())t.cleanup()}drawMesh(t,n,e,r){if(this.meshRenderers.has(t)){this.gl.uniform3fv(this.shaderLocations.getUniformLocation("material.ambient"),n.getAmbient()),this.gl.uniform3fv(this.shaderLocations.getUniformLocation("material.diffuse"),n.getDiffuse()),this.gl.uniform3fv(this.shaderLocations.getUniformLocation("material.specular"),n.getSpecular()),this.gl.uniform1f(this.shaderLocations.getUniformLocation("material.shininess"),n.getShininess());let e=this.shaderLocations.getUniformLocation("modelview");this.gl.uniformMatrix4fv(e,!1,r);let i=a.mat4.clone(r);a.mat4.transpose(i,i),a.mat4.invert(i,i),this.gl.uniformMatrix4fv(this.shaderLocations.getUniformLocation("normalmatrix"),!1,i),this.meshRenderers.get(t).draw(this.shaderLocations)}}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(3)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.RenderableMesh=class{constructor(t,n){this.gl=t,this.vbo=t.createBuffer(),this.ibo=t.createBuffer(),this.numIndices=0,this.name=n,this.offsets=new Map,this.shaderVarsToAttribs=new Map,this.vertexDataLengths=new Map}initMeshForRendering(t,n){let r;switch(this.shaderVarsToAttribs=t,n.getFaceType()){case e.Mesh.FaceType.Triangle:this.faceType=this.gl.TRIANGLES;break;case e.Mesh.FaceType.TriangleFan:this.faceType=this.gl.TRIANGLE_FAN;break;case e.Mesh.FaceType.TriangleStrip:this.faceType=this.gl.TRIANGLE_STRIP;break;case e.Mesh.FaceType.Lines:this.faceType=this.gl.LINES;break;case e.Mesh.FaceType.LineStrip:this.faceType=this.gl.LINE_STRIP;break;case e.Mesh.FaceType.LineLoop:this.faceType=this.gl.LINE_LOOP}this.vbo=this.gl.createBuffer(),this.ibo=this.gl.createBuffer();let a=n.getVertexAttributes(),i=n.getIndices(),o=new Uint16Array(i);this.numIndices=o.length;let s=0;for(let[t,n]of this.shaderVarsToAttribs){this.offsets.set(n,s);let t=a[0].getData(n).length;s+=t,this.vertexDataLengths.set(n,t)}this.shaderVarsToAttribs.size>1?this.stride=s:this.stride=0;let u=[];a.forEach(t=>{for(let[n,e]of this.shaderVarsToAttribs){let n=t.getData(e);for(r=0;r<n.length;r++)u.push(n[r])}}),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(u),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,o,this.gl.STATIC_DRAW)}cleanup(){this.gl.deleteBuffer(this.vbo),this.gl.deleteBuffer(this.ibo)}draw(t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo);for(let[n,e]of this.shaderVarsToAttribs){let r=t.getAttribLocation(n);r>=0&&(this.gl.vertexAttribPointer(r,this.vertexDataLengths.get(e),this.gl.FLOAT,!1,4*this.stride,4*this.offsets.get(e)),this.gl.enableVertexAttribArray(r))}this.gl.drawElements(this.faceType,this.numIndices,this.gl.UNSIGNED_SHORT,0)}setName(t){this.name=t}getName(){return this.name}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(13),e(14),e(15),e(16),e(0),e(17),e(18),e(4)],void 0===(a=function(t,n,e,r,a,i,o,s,u,c){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){function n(t,n){let e=null;if(!("type"in n))throw new Error("No type of node!");switch(n.type){case"transform":e=h(t,n);break;case"group":e=l(t,n);break;case"object":e=d(t,n);break;default:throw new Error("Unknown node type")}if("lights"in n){for(let t of Object(n.lights)){let n=new c.Light;n.setAmbient(t.ambient),n.setDiffuse(t.diffuse),n.setPosition(t.position),n.setSpecular(t.specular),"spotdirection"in t?(n.setSpotDirection(t.spotdirection),n.setSpotAngle(o.glMatrix.toRadian(t.spotcutoff))):n.setSpotAngle(Math.PI),e.addLight(n)}console.log(e.getLights())}return e}function h(t,e){let r,a="t",s=o.mat4.create();if("name"in e&&(a=e.name),r=new i.TransformNode(t,a),!("child"in e))throw new Error("No child for a transform node");if(!("transform"in e))throw new Error("No transform property for a transform node");for(let t of Object(e.transform))if("translate"in t){let n=f(t.translate);if(3!=n.length)throw new Error("3 values needed for translate");let e=o.vec3.fromValues(n[0],n[1],n[2]);o.mat4.translate(s,s,e)}else if("scale"in t){let n=f(t.scale);if(3!=n.length)throw new Error("3 values needed for scale");let e=o.vec3.fromValues(n[0],n[1],n[2]);o.mat4.scale(s,s,e)}else if("rotate"in t){let n=f(t.rotate);if(4!=n.length)throw new Error("4 values needed for rotate");let e=n[0],r=o.vec3.fromValues(n[1],n[2],n[3]);o.mat4.rotate(s,s,o.glMatrix.toRadian(e),r)}return r.addChild(n(t,e.child)),r.setTransform(s),r}function f(t){let n=[];for(let e in t)n.push(parseFloat(t[e]));return n}function l(t,e){let a,i="g";"name"in e&&(i=e.name),a=new r.GroupNode(t,i);for(let r of e.children){let e=n(t,r);a.addChild(e)}return a}function d(t,n){let e,r="g";"name"in n&&(r=n.name);let a=new u.Material;return e=new s.LeafNode(n.instanceof,t,r),"material"in n&&("color"in n.material?a.setAmbient([n.material.color[0],n.material.color[1],n.material.color[2]]):(a.setAmbient(n.material.ambient),a.setSpecular(n.material.specular),a.setDiffuse(n.material.diffuse),a.setShininess(n.material.shininess)),e.setMaterial(a)),e}function m(t,n,e){return new Promise(r=>{let i=new Map;for(let t of Object.keys(n)){let e=n[t].path;i.set(n[t].name,e)}a.ObjImporter.batchDownloadMesh(i,e).then(n=>{for(let[e,r]of n)t.addPolygonMesh(e,r);r(t)})})}t.importJSON=function(t,r){return new Promise((a,i)=>{let o,s=JSON.parse(r),u=new e.Scenegraph;if(!("instances"in s))throw new Error("No meshes in the scene graph!");m(u,s.instances,t).then(t=>{if(!("root"in s))throw new Error("No root in the scene graph!");o=n(t,s.root),t.makeScenegraph(o),a(t)})})},t.handleNode=n,t.handleTransformNode=h,t.convertToArray=f,t.handleGroupNode=l,t.handleLeafNode=d,t.handleInstances=m}(n.ScenegraphJSONImporter||(n.ScenegraphJSONImporter={}))}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(0)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Scenegraph=class{constructor(){this.root=null,this.meshes=new Map,this.nodes=new Map,this.textures=new Map}dispose(){this.renderer.dispose()}setRenderer(t){this.renderer=t;for(let[t,n]of this.meshes)this.renderer.addMesh(t,n)}makeScenegraph(t){this.root=t,this.root.setScenegraph(this)}draw(t){null!=this.root&&null!=this.renderer&&this.renderer.draw(this.root,t)}findLights(t){return this.root.findLights(t)}addPolygonMesh(t,n){this.meshes.set(t,n)}animate(t,n,r,a){if(null!=n){let i=this.getNodes().get("aeroplane"),o=e.mat4.create(),s=t%r;e.mat4.translate(o,o,n.getPositionByIndex(s)),e.mat4.invert(o,a),e.mat4.rotate(o,o,e.glMatrix.toRadian(90),e.vec3.fromValues(-1,0,0)),i.setTransform(o)}}addNode(t,n){this.nodes.set(t,n)}getRoot(){return this.root}getPolygonMeshes(){return this.meshes}getNodes(){return this.nodes}addTexture(t,n){this.textures.set(t,n)}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(2)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends e.SGNode{constructor(t,n){super(t,n),this.children=[]}getNode(t){let n=super.getNode(t);if(null!=n)return n;let e=0,r=null;for(;e<this.children.length&&null==r;)r=this.children[e].getNode(t),e++;return r}setScenegraph(t){super.setScenegraph(t),this.children.forEach(n=>n.setScenegraph(t))}draw(t,n){this.children.forEach(e=>e.draw(t,n))}findLights(t){let n=this.getTransformedLights(t.peek());return this.children.forEach(e=>n=n.concat(e.findLights(t))),n}clone(){let t=[];this.children.forEach(n=>t.push(n.clone()));let n=new r(this.scenegraph,name);return this.children.forEach(t=>n.addChild(t)),n}addChild(t){this.children.push(t),t.setParent(this)}getChildren(){return this.children}}n.GroupNode=r}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(3),e(0)],void 0===(a=function(t,n,e,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){function n(t,n,a){class i{constructor(t,n,e){this.vertexIndex=t,this.textureIndex=n,this.normalIndex=e}hash(){return this.vertexIndex+","+this.textureIndex+","+this.normalIndex}}let o,s,u,c,h,f,l,d,m,p=new Map;s=[],u=[],c=[],l=[],f=[],h=[];let v=n.split(/\r?\n/);m=0,v.forEach(t=>{if(t=t.trim(),m++,t.length>0&&!t.startsWith("#")){let n=t.split(/\s+/);switch(n[0]){case"v":{if(n.length<4||n.length>7)throw new Error("Line "+m+": Vertex coordinate has an invalid number of values");let t=r.vec4.create();if(t[0]=parseFloat(n[1]),t[1]=parseFloat(n[2]),t[2]=parseFloat(n[3]),t[3]=1,5==n.length){let e=parseFloat(n[4]);0!=e&&(t[0]/=e,t[1]/=e,t[2]/=e)}s.push(t)}break;case"vn":{if(4!=n.length)throw new Error("Line "+m+": Normal has an invalid number of values");let t=r.vec3.create();t[0]=parseFloat(n[1]),t[1]=parseFloat(n[2]),t[2]=parseFloat(n[3]),r.vec3.normalize(t,t),u.push(r.vec4.fromValues(t[0],t[1],t[2],0))}break;case"vt":{if(n.length<3||n.length>4)throw new Error("Line "+m+": Texture coordinate has an invalid number of values");let t=r.vec4.create();t[0]=parseFloat(n[1]),t[1]=parseFloat(n[2]),t[2]=0,t[3]=1,n.length>3&&(t[2]=parseFloat(n[3])),c.push(t)}break;case"f":if(n.length<4)throw new Error("Line "+m+": Face has too few vertices, must be at least 3");for(n.shift(),n=function(t){let n=[];if(t.length<=3)n=t;else for(let e=1;e<t.length-1;e++)n.push(t[0]),n.push(t[e]),n.push(t[e+1]);return n}(n),d=0;d<n.length;d++){let t=n[d].split("/");if(t.length<1&&t.length>3)throw new Error("Line "+m+": Face specification has an incorrect number of values");let e=parseInt(t[0])-1,r=-1,a=-1;t.length>1&&(t[1].length>0&&(r=parseInt(t[1])-1),t.length>2&&(a=parseInt(t[2])-1)),h.push(new i(e,r,a))}}}});let M=!1,b=!1;if(u.length>0&&(M=!0),c.length>0&&(b=!0),h.forEach(n=>{let e=n.hash(),r=-1;if(e in p)r=p.get(e);else{let a=t.produce();a.setData("position",[s[n.vertexIndex][0],s[n.vertexIndex][1],s[n.vertexIndex][2]]),M&&a.setData("normal",[u[n.normalIndex][0],u[n.normalIndex][1],u[n.normalIndex][2]]),b&&a.setData("texcoord",[c[n.textureIndex][0],c[n.textureIndex][1],c[n.textureIndex][2]]),f.push(a),p.set(e,f.length-1),r=f.length-1}l.push(r)}),(o=new e.Mesh.PolygonMesh).setVertexData(f),o.setPrimitives(l,e.Mesh.FaceType.Triangle),a){o=new e.Mesh.CanonicalMesh(o).getMesh()}return o}t.downloadMesh=function(t,e,r=!0){return new Promise(a=>{let i,o;i=fetch(t).then(t=>t.text()).then(t=>o=n(e,t,r)),Promise.resolve(i).then(t=>{a(t)})})},t.batchDownloadMesh=function(t,e,r=!0){return new Promise(a=>{let i=[],o=new Map;for(let[a,o]of t)i.push(fetch(o).then(t=>t.text()).then(t=>{let i=n(e,t,r);return[a,i]}));Promise.all(i).then(t=>{for(let[n,e]of t)o.set(n,e);a(o)})})},t.importMesh=n}(n.ObjImporter||(n.ObjImporter={}))}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(2),e(0)],void 0===(a=function(t,n,e,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class a extends e.SGNode{constructor(t,n){super(t,n),this.transform=r.mat4.create(),this.animationTransform=r.mat4.create(),this.child=null}clone(){let t;t=null!=this.child?this.child.clone():null;let n=new a(this.scenegraph,this.name);if(n.setTransform(this.transform),n.setAnimationTransform(this.animationTransform),null!=t)try{n.addChild(t)}catch(t){}return n}getNode(t){let n=super.getNode(t);return null!=n?n:null!=this.child?this.child.getNode(t):null}addChild(t){if(null!=this.child)throw new Error("Transform node already has a child");this.child=t,this.child.setParent(this)}draw(t,n){n.push(r.mat4.clone(n.peek())),r.mat4.multiply(n.peek(),n.peek(),this.animationTransform),r.mat4.multiply(n.peek(),n.peek(),this.transform),null!=this.child&&this.child.draw(t,n),n.pop()}findLights(t){let n=[];return t.push(r.mat4.clone(t.peek())),r.mat4.multiply(t.peek(),t.peek(),this.animationTransform),r.mat4.multiply(t.peek(),t.peek(),this.transform),n=this.getTransformedLights(t.peek()),null!=this.child&&(n=n.concat(this.child.findLights(t))),t.pop(),n}setAnimationTransform(t){this.animationTransform=t}getTransform(){return this.transform}setTransform(t){this.transform=r.mat4.clone(t)}getAnimationTransform(){return this.animationTransform}setScenegraph(t){super.setScenegraph(t),null!=this.child&&this.child.setScenegraph(t)}}n.TransformNode=a}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(2)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends e.SGNode{constructor(t,n,e){super(n,e),this.meshName=t}setMaterial(t){this.material=t}setTextureName(t){this.textureName=t}getMaterial(){return this.material}clone(){let t=new r(this.meshName,this.scenegraph,this.name);return t.setMaterial(this.getMaterial()),t}draw(t,n){this.meshName.length>0&&t.drawMesh(this.meshName,this.material,this.textureName,n.peek())}findLights(t){return this.getTransformedLights(t.peek())}}n.LeafNode=r}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(0)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Material=class{constructor(){this.emission=e.vec3.create(),this.ambient=e.vec3.create(),this.diffuse=e.vec3.create(),this.specular=e.vec3.create(),this.init()}Material(t){this.emission=new e.vec3(t.getEmission()),this.ambient=new e.vec3(t.getAmbient()),this.diffuse=new e.vec3(t.getDiffuse()),this.specular=new e.vec3(t.getSpecular()),this.setShininess(t.getShininess()),this.setAbsorption(t.getAbsorption()),this.setReflection(t.getReflection()),this.setTransparency(t.getTransparency()),this.setRefractiveIndex(t.getRefractiveIndex())}init(){this.setEmission([0,0,0]),this.setAmbient([0,0,0]),this.setDiffuse([0,0,0]),this.setSpecular([0,0,0]),this.setShininess(0),this.setAbsorption(1),this.setReflection(0),this.setTransparency(0)}setEmission(t){this.emission=e.vec3.fromValues(t[0],t[1],t[2])}setAmbient(t){this.ambient=e.vec3.fromValues(t[0],t[1],t[2])}setDiffuse(t){this.diffuse=e.vec3.fromValues(t[0],t[1],t[2])}setSpecular(t){this.specular=e.vec3.fromValues(t[0],t[1],t[2])}setShininess(t){this.shininess=t}setAbsorption(t){this.absorption=t}setReflection(t){this.reflection=t}setTransparency(t){this.transparency=t,this.ambient[3]=this.diffuse[3]=this.specular[3]=this.emission[3]=1-t}setRefractiveIndex(t){this.refractive_index=t}getEmission(){return e.vec3.fromValues(this.emission[0],this.emission[1],this.emission[2])}getAmbient(){return e.vec3.fromValues(this.ambient[0],this.ambient[1],this.ambient[2])}getDiffuse(){return e.vec3.fromValues(this.diffuse[0],this.diffuse[1],this.diffuse[2])}getSpecular(){return e.vec3.fromValues(this.specular[0],this.specular[1],this.specular[2])}getShininess(){return this.shininess}getAbsorption(){return this.absorption}getReflection(){return this.reflection}getTransparency(){return this.transparency}getRefractiveIndex(){return this.refractive_index}}}.apply(n,r))||(t.exports=a)},function(t,n,e){var r,a;r=[e,n,e(0)],void 0===(a=function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){t.downloadPlaneAttributes=function(t){return new Promise(n=>{fetch(t).then(t=>t.text()).then(t=>n(new r(t)))})}}(n.PlaneAttributesImporter||(n.PlaneAttributesImporter={}));class r{constructor(t){this.numTokens=6,this.listPositions=[],this.listUpVecs=[],this.parseString(t)}parseString(t){(t=t.trim()).split(/\r?\n/).forEach((t,n)=>{if(t=t.trim(),0===n)this.numPositions=parseInt(t);else{let n=t.split(/\s+/),r=n.map(t=>parseFloat(t));n.length===this.numTokens&&(this.listPositions.push(e.vec3.fromValues(r[0],r[1],r[2])),this.listUpVecs.push(e.vec3.fromValues(r[3],r[4],r[5])))}})}getNumPositions(){return this.numPositions}getPositionByIndex(t){return this.listPositions[t]}getUpVecByIndex(t){return this.listUpVecs[t]}}n.PlaneAttributes=r}.apply(n,r))||(t.exports=a)},function(t,n,e){var r;void 0===(r=function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Controller=class{constructor(t){this.view=t,this.view.setFeatures(this)}go(){this.view.initShaders(this.getPhongVShader(),this.getPhongFShader(5)),this.view.initScenegraph(),this.view.initPlaneAttribs(),this.view.draw()}getVShader(){return"attribute vec4 vPosition;\n        uniform vec4 vColor;\n        uniform mat4 proj;\n        uniform mat4 modelview;\n        varying vec4 outColor;\n        \n        void main()\n        {\n            gl_Position = proj * modelview * vPosition;\n            outColor = vColor;\n        }\n        "}getFShader(){return"precision mediump float;\n        varying vec4 outColor;\n    \n        void main()\n        {\n            gl_FragColor = outColor;\n        }\n        "}getPhongVShader(){return"\n        attribute vec4 vPosition;\n        attribute vec4 vNormal;\n        //attribute vec2 vTexCoord;\n        \n        uniform mat4 projection;\n        uniform mat4 modelview;\n        uniform mat4 normalmatrix;\n        //uniform mat4 texturematrix;\n        varying vec3 fNormal;\n        varying vec4 fPosition;\n        //varying vec4 fTexCoord;\n        \n        void main()\n        {\n            vec3 lightVec,viewVec,reflectVec;\n            vec3 normalView;\n            vec3 ambient,diffuse,specular;\n        \n            fPosition = modelview * vPosition;\n            gl_Position = projection * fPosition;\n        \n        \n            vec4 tNormal = normalmatrix * vNormal;\n            fNormal = normalize(tNormal.xyz);\n        \n            //fTexCoord = texturematrix * vec4(vTexCoord.s,vTexCoord.t,0,1);\n        \n        }\n        \n    "}getPhongFShader(t){return"precision mediump float;\n\n        struct MaterialProperties\n        {\n            vec3 ambient;\n            vec3 diffuse;\n            vec3 specular;\n            float shininess;\n        };\n        \n        struct LightProperties\n        {\n            vec3 ambient;\n            vec3 diffuse;\n            vec3 specular;\n            vec4 position;\n            vec4 spotDirection;\n            float spotCutoff;\n        };\n        \n        \n        varying vec3 fNormal;\n        varying vec4 fPosition;\n        //varying vec4 fTexCoord;\n        \n        \n        uniform MaterialProperties material;\n        uniform LightProperties light["+t+"];\n        \n        /* texture */\n        //uniform sampler2D image;\n        \n        void main()\n        {\n            vec3 lightVec,viewVec,reflectVec;\n            vec3 normalView;\n            vec3 ambient,diffuse,specular;\n            float nDotL,rDotV;\n            vec4 result;\n        \n        \n            result = vec4(0,0,0,1);\n        for (int i=0;i<"+t+";i++)\n            {\n                if (light[i].position.w!=0.0)\n                    lightVec = normalize(light[i].position.xyz - fPosition.xyz);\n                else\n                    lightVec = normalize(-light[i].position.xyz);\n        \n                vec3 tNormal = fNormal;\n                normalView = normalize(tNormal.xyz);\n                nDotL = dot(normalView,lightVec);\n        \n                viewVec = -fPosition.xyz;\n                viewVec = normalize(viewVec);\n        \n                reflectVec = reflect(-lightVec,normalView);\n                reflectVec = normalize(reflectVec);\n        \n                rDotV = max(dot(reflectVec,viewVec),0.0);\n        \n                ambient = material.ambient * light[i].ambient;\n                diffuse = material.diffuse * light[i].diffuse * max(nDotL,0.0);\n                if (nDotL>0.0)\n                    specular = material.specular * light[i].specular * pow(rDotV,material.shininess);\n                else\n                    specular = vec3(0,0,0);\n                float phi = dot(light[i].spotDirection.xyz, -lightVec);\n                if (phi > cos(light[i].spotCutoff)) \n                    result = result + vec4(ambient+diffuse+specular,1.0);\n                \n            }\n            gl_FragColor = result;\n        }\n        \n    "}}}.apply(n,[e,n]))||(t.exports=r)}]);
//# sourceMappingURL=Scenegraphs.js.map